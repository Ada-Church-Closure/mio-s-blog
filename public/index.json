
[{"content":"","date":"12 March 2025","externalUrl":null,"permalink":"/","section":"Mio's Tea Time","summary":"","title":"Mio's Tea Time","type":"page"},{"content":" Computer Organization # [!NOTE]\nåœ¨æœ¬ç¯‡ä¹‹å‰ï¼Œæˆ‘å·²ç»å®ç°äº†ä¸€ä¸ªéå¸¸ç®€å•çš„CPUï¼ˆæ„Ÿè§‰éƒ½æ˜¯å±äºæ•°å­—ç”µè·¯çš„å†…å®¹ï¼Œå½“ç„¶ä¹Ÿæ˜¯è®¡ç»„çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œè¯¾ç¨‹ç¬”è®°ä»¥åŠèµ„æºéƒ½æ¥è‡ªäºBç«™ï¼šCs Primerã€‚\næ‰€ä»¥åœ¨è¿™é‡Œåªæ˜¯ç®€å•è®°å½•ä¸€äº›æ„Ÿè§‰æœ‰å¿…è¦çš„ç†è®ºçŸ¥è¯†ï¼Œè¿˜ä¼šä¸æ–­è¡¥å……ã€‚\nCacheï¼ˆå­˜å‚¨å™¨å±‚æ¬¡ç»“æ„ï¼‰ # 1.DRAM SRAM SSD æœºæ¢°ç¡¬ç›˜è¯»å†™ä»¥åŠå­˜å‚¨ï¼Œå–å†…å­˜å’Œå®é™…CPUä¹‹é—´çš„å·®å¼‚æ€§ã€‚\n2.ç¨‹åºçš„å±€éƒ¨æ€§ï¼ˆLocalityï¼‰:ç¨‹åºå€¾å‘äºå¼•ç”¨é‚»è¿‘äºæœ€è¿‘å¼•ç”¨è¿‡çš„æ•°æ®é¡¹æˆ–è€…æ˜¯å·²ç»å¼•ç”¨è¿‡çš„æ•°æ®é¡¹æœ¬èº«ï¼ˆforéå†æ•°ç»„ï¼‰\na.ç©ºé—´å±€éƒ¨æ€§ b.æ—¶é—´å±€éƒ¨æ€§\nå¼•å…¥ï¼š\né«˜é€Ÿç¼“å­˜å­˜å‚¨å™¨ # 1.ç»“æ„ # SBEä¸ºæ€»çš„å¤§å°ã€‚\nå¯»å€åŸç†ï¼šhash\n2.ç›´æ¥æ˜ å°„é«˜é€Ÿç¼“å­˜ï¼ˆdirect-mapped cacheï¼‰ # å°±æ˜¯æ¯ç»„åªæœ‰ä¸€ä¸ªè¡Œ\nè¿‡ç¨‹\na.ç»„é€‰æ‹©\nä¸ºä»€ä¹ˆæŠŠä¸­é—´çš„ä½ä½œä¸ºç»„ç´¢å¼•è€Œä¸æ˜¯æ›´é«˜çš„ä½ï¼Ÿ\nå¦‚æœé«˜ä½åšç´¢å¼•ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“æŠŠä¸€å †è¿ç»­çš„å—æ˜ å°„åˆ°ä¸€ç»„é«˜é€Ÿç¼“å­˜å—é‡Œé¢ï¼Œè¿™æ ·ä¸ç¬¦åˆç©ºé—´å±€éƒ¨æ€§ã€‚\nä¸­é—´çš„éšæœºæ€§ç›¸å¯¹æ›´å¤§ä¸€äº›ã€‚\nb.æ‰¾åˆ°äº†ç»„ï¼Œè¿›è¡Œè¡ŒåŒ¹é…\nc.æ ¹æ®å—åç§»ä½æ¥å¯»æ‰¾ç¬¬ä¸€ä¸ªå­—èŠ‚çš„ä½ç½®\nd.å¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œä»ä¸‹ä¸€çº§å†…å­˜ä¸­å–ç›¸åº”çš„å†…å­˜å—å¹¶ä¸”ç›´æ¥åšæ›¿æ¢çš„æ“ä½œ\ne.å®é™…è¿‡ç¨‹ï¼šå¼€å§‹ç¼“å­˜ä¸ºç©ºï¼Œå†·ä¸å‘½ä¸­ï¼Œä»L2ä¸­åŠ è½½æ•°æ®åˆ°L1,ç„¶åè¿”å›ï¼Œæ¥ç€å‡å¦‚æ ‡å¿—ä½ä¸ç›¸åŒï¼Œå‘ç”Ÿå†²çªä¸å‘½ä¸­ï¼Œè¿›è¡Œæ›¿æ¢æ“ä½œã€‚\nd.å†²çªä¸å‘½ä¸­å¸¸è§ï¼šthrash,é«˜é€Ÿç¼“å­˜åå¤çš„åŠ è½½å’Œé©±é€ç›¸åŒçš„ä¸€äº›ç»„ã€‚\n3.ç»„ç›¸è”é«˜é€Ÿç¼“å­˜(set associative cache) # å°±æ˜¯æ¯ä¸ªç»„åŒ…å«å¤šäºä¸€ä¸ªçš„è¡Œ\nå’Œæ¯ä¸ªè¡Œè¿›è¡Œä¸€æ¬¡åŒ¹é…\nLFUå’ŒLRUç­–ç•¥\n4.å…¨ç›¸è”é«˜é€Ÿç¼“å­˜ï¼ˆfully asscociative cacheï¼‰ # å°±æ˜¯åªæœ‰ä¸€ä¸ªç»„ï¼Œé‡Œé¢æœ‰å¾ˆå¤šè¡Œ\næ²¡æœ‰ç»„çš„é€‰æ‹©ï¼Œåªæœ‰æ ‡è®°ä½å’Œå—åç§»ã€‚\nå•å‘¨æœŸå¤šå‘¨æœŸå¤„ç†å™¨ # ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å®Œæˆä¸€æ¡æŒ‡ä»¤\nå¤šå‘¨æœŸå°±æ˜¯ä¸€æ¡æŒ‡ä»¤å¤šä¸ªæ—¶é’Ÿå‘¨æœŸ\næµæ°´çº¿æŠ€æœ¯ # äº”é˜¶æ®µæµæ°´çº¿ # æŠŠæ¯ä¸ªæŒ‡ä»¤éƒ½å¡«å……æˆäº”ä¸ªé˜¶æ®µï¼Œé˜²æ­¢å†²çª\næµæ°´çº¿å†’é™© # ç»“æ„å†’é™©ï¼šç¡¬ä»¶èµ„æºäº§ç”Ÿå†²çª # æ•°æ®å†’é™©ï¼šé€»è¾‘ä¸Šçš„æ•°æ®ä¾èµ–æ€§äº§ç”Ÿå†²çª # æ§åˆ¶å†’é™©ï¼šè·³è½¬åˆ°åˆ«çš„æŒ‡ä»¤ï¼Œå¯¼è‡´æµæ°´çº¿ä¹‹å‰å‡†å¤‡çš„æŒ‡ä»¤æ— æ•ˆ # è§£å†³ï¼šåˆ†æ”¯é¢„æµ‹ï¼ˆåŠ¨æ€ï¼‰\nåœ¨X86ç³»ç»Ÿä¸Šç¼–å†™å’Œè¿è¡Œç¨‹åº # ä¸€ä¸ªCç¨‹åºå¤„ç†æµç¨‹ # é¢„å¤„ç†-ç¼–è¯‘-æ±‡ç¼–-é“¾æ¥-ç¨‹åºåŠ è½½æ‰§è¡Œ\nå‡è®¾æˆ‘ä»¬æœ‰æ–‡ä»¶main.c hello.c\ngcc main.c hello.c\t//è¿™ä¸€æ¡æŒ‡ä»¤åŒ…å«äº†ä¸Šè¿°çš„å››ä¸ªæ­¥éª¤ gcc -E hello.c -o hello.i //è¿™è¡¨ç¤ºå¯¹äºæ–‡ä»¶è¿›è¡Œé¢„å¤„ç† -oæ˜¯æŒ‡å®šåç§°ï¼ˆæ“¦é™¤å¹¶ä¸”è¿›è¡Œå¤åˆ¶ç²˜è´´çš„æµç¨‹ï¼‰ gcc -S hello.i -o hello.s\t//æŠŠé¢„å¤„ç†ä¹‹åçš„æ–‡ä»¶å¤„ç†æˆæ±‡ç¼–ä»£ç  gcc -c hello.s -o hello.o\t//æ±‡ç¼–æˆä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯ä¸è¿›è¡Œé“¾æ¥çš„æ“ä½œ å·¥å…·ï¼šreadelfï¼ˆæŸ¥çœ‹æ®µçš„åç§»ï¼‰ objdumpï¼ˆåæ±‡ç¼–ï¼‰ hexdumpï¼ˆæŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶çš„æœºå™¨ç ï¼‰\ngcc main.o hello.o\t//ç›´æ¥å°†ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œé“¾æ¥ï¼Œå¦‚ä¸‹æ˜¯é“¾æ¥çš„è¿‡ç¨‹ æ¥ç€æ˜¯ç¨‹åºåŠ è½½æ‰§è¡Œçš„æµç¨‹\nå¸¸è§X86æ±‡ç¼–æŒ‡ä»¤ # å¯ä»¥å‚ç…§CSAPPç†Ÿæ‚‰åŸºæœ¬è¯­æ³•ï¼Œè¾¾åˆ°èƒ½è¯»çš„è¦æ±‚å³å¯\n[!TIP]\njmpç±»æ¡ä»¶è·³è½¬æŒ‡ä»¤ä¹‹å‰å¯ä»¥è·Ÿå…¶ä»–è®¸å¤šæŒ‡ä»¤\næ¯”å¦‚ subl a,b ä¹Ÿå¯ä»¥çœ‹aå’Œbä¹‹é—´æ»¡è¶³çš„æ¡ä»¶\n64ä½ä½¿ç”¨çš„å¯„å­˜å™¨ # æ•°æ®ä¼ é€æŒ‡ä»¤ # moveï¼šä¸èƒ½ä»å†…å­˜ç›´æ¥åˆ°å†…å­˜ä¼ é€ # [!NOTE]\næˆ‘çœ‹è¿‡å¥½å‡ éä¹¦ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰è‡ªå·±æœ€éš¾ç†è§£çš„åœ°æ–¹å°±æ˜¯å‡½æ•°çš„è°ƒç”¨ä»¥åŠé€’å½’è¿™é‡Œçš„ä¸œè¥¿ï¼Œå»ºè®®å¤§å®¶ä»pushè¿™é‡Œå¼€å§‹ç»†ç»†ç†è§£ã€‚\npushæŒ‡ä»¤ï¼š # 1.æŠŠæ ˆæŒ‡é’ˆå‡å»8,å¾—åˆ°æ ˆé¡¶ä½ç½®ï¼Œæ­¤æ—¶æ ˆé¡¶è¿˜æ²¡æœ‰å…ƒç´ ã€‚2.æŠŠç›®çš„æ“ä½œæ•°æ”¾åˆ°æ ˆé¡¶ã€‚ï¼ˆpushåªè¦ä¸€ä¸ªbyteï¼Œæ ˆä¸Šåªæ˜¯æ”¾äº†ä¸€å †dataï¼Œå’Œå¯„å­˜å™¨ï¼Œå’Œå†…å­˜éƒ½æ²¡æœ‰å…³ç³»ï¼‰\né‚£ä¹ˆpopæŒ‡ä»¤åŒç†ï¼š1.æŠŠæ ˆé¡¶çš„å€¼è¯»å…¥ä¸€ä¸ªç›®æ ‡å¯„å­˜å™¨ã€‚2.æŠŠæ ˆæŒ‡é’ˆåŠ 8ã€‚\næ¡ä»¶æ§åˆ¶ # if for whileç­‰è¯­å¥éƒ½æ˜¯æ¡ä»¶è·³è½¬æ¥å®ç°çš„\nswitchè¯­å¥å½“caseèŒƒå›´è¾ƒå¤§æ—¶ä¹Ÿæ˜¯æ¡ä»¶è·³è½¬ï¼Œå½“èŒƒå›´è¾ƒå°æ˜¯åˆ©ç”¨è·³è½¬è¡¨ï¼Œä¸€ä¸ªè¿ç»­æ•°ç»„çš„å€¼åŸŸåŒ…å«äº†æ‰€æœ‰çš„caseæƒ…å†µ(å¹¶ä¸”caseçš„æ•°é‡è¾ƒå¤š)\n*Processï¼ˆè¿‡ç¨‹ï¼‰ # æ§åˆ¶ + ä¼ é€’ + å†…å­˜ç®¡ç†\nè¿è¡Œæ—¶æ ˆï¼ˆæå‰å‡†å¤‡ï¼‰ # På»è°ƒç”¨Qï¼Œé¦–å…ˆå­˜æ”¾è¿”å›åœ°å€ï¼Œè¡¨æ˜Qè¿”å›æ—¶ä»Pçš„å“ªä¸ªä½ç½®å¼€å§‹æ‰§è¡Œï¼Œè¿™ä¸ªåœ°å€ä¹Ÿæ˜¯Pæ ˆå¸§çš„ä¸€éƒ¨åˆ†ã€‚\næ¥ç€ä¸ºQåˆ†é…ä¸€ä¸ªæ ˆå¸§ï¼Œå¤§å¤šæ•°çš„æ ˆå¸§éƒ½æ˜¯å®šé•¿çš„ï¼Œé€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼Œå¦‚æœå¤§äº6ä¸ªï¼ŒPåœ¨è°ƒç”¨Qä¹‹å‰æå‰åœ¨è‡ªå·±çš„æ ˆå¸§é‡Œå­˜å‚¨å¥½è¿™äº›å‚æ•°ã€‚\nè½¬ç§»æ§åˆ¶ï¼ˆæ€ä¹ˆäº¤æ¥æ§åˆ¶æƒåˆ©ï¼‰ # call:æŠŠripçš„å€¼è®¾ç½®æˆcalleeçš„é¦–åœ°å€ï¼Œè¿™æ ·å°±æŠŠæ‰§è¡Œæƒåˆ©è½¬æ¢ï¼Œæ¥ç€æŠŠcallæŒ‡ä»¤ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å‹å…¥æ ˆä¸­ã€‚\nretï¼šæŠŠå‹å…¥æ ˆçš„åœ°å€å¼¹å‡ºæ¥ï¼Œå¹¶ä¸”æŠŠripçš„å€¼è®¾ç½®æˆè¿™ä¸ªåœ°å€ï¼Œè¿™æ ·å°±äº¤è¿˜äº†æ§åˆ¶æƒåˆ©ã€‚\næ•°æ®ä¼ é€ï¼ˆæ€ä¹ˆç»™Calleeä¼ é€’ä¸€äº›å‚æ•°ï¼‰ # åœ¨å‚æ•°å°äº6ä¸ªçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨å¯„å­˜å™¨æ¥ä¼ é€’ï¼Œç”¨raxæ¥è·å¾—è°ƒç”¨æ–¹æ³•çš„è¿”å›å€¼å³å¯ã€‚\nåœ¨ä¸Šå›¾çš„Current frameä¸­æœ‰ä¸€ä¸ªArgument build areaï¼Œè¿™å°±æ˜¯ä¸€ä¸ªå‚æ•°æ„é€ åŒºï¼Œå¦‚æœå®ƒä¹Ÿè¦è°ƒç”¨ä¸€ä¸ªå‚æ•°å¤šäº6ä¸ªçš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±è¦æå‰åœ¨è‡ªå·±çš„æ ˆå¸§é‡Œå‡†å¤‡å¥½ï¼Œå†æ‰§è¡ŒcallæŒ‡ä»¤ï¼ˆæ³¨æ„ï¼šç¬¬ä¸ƒä¸ªå‚æ•°ä¼šåœ¨æ ˆçš„é¡¶éƒ¨ï¼‰ã€‚\næ ˆä¸Šçš„å±€éƒ¨å­˜å‚¨ï¼ˆCalleeä¸­çš„å±€éƒ¨å˜é‡æ˜¯æ€ä¹ˆå®ç°çš„ï¼‰ # æ¯”å¦‚å±€éƒ¨å˜é‡å¤ªå¤šï¼Œè¦å–å±€éƒ¨å˜é‡çš„ä¸€ä¸ªåœ°å€ï¼Œæˆ–è€…å±€éƒ¨å˜é‡æ˜¯æ•°ç»„åŠç»“æ„ä½“ç­‰ã€‚\nè¿˜æ˜¯ä¸Šå›¾ï¼Œå‚æ•°æ„é€ åŒºä¹‹ä¸Šå°±æ˜¯æˆ‘ä»¬å‡å°‘æ ˆæŒ‡é’ˆåˆ†é…ç»™å±€éƒ¨å˜é‡çš„ç©ºé—´ã€‚\nä¸‹ä¾‹å‡ºè‡ªCSAPP\nlong swap_add (long *XP , long * yp) { long x = *xp ; long y = * yp ; *xp = y ; *yp = x ; return x + y ; } long caller () { //è¦å¤„ç†ä»¥ä¸‹ä¸¤ä¸ªå±€éƒ¨å˜é‡ï¼Œæˆ‘å°±è¦ä¸ºä»–ä»¬äº§ç”Ÿåœ°å€ã€‚ long argl = 534 ; long arg2 = 1057 ; long sum = swap_add (\u0026amp;argl , \u0026amp;arg2) ; long diff = argl - arg2 ; return sum * diff; } ä»¥ä¸‹æ˜¯æ±‡ç¼–ä»£ç \nlong caller() caller: subq $16 , %rsp movq $534 , (%rsp) movq $1057 , 8(%rsp) leaq 8(%rsp) , %rsi movq %rsp , %rdi call swap_add\t;è¿™é‡Œçš„ç»†èŠ‚ï¼šæ–¹æ³•è™½ç„¶å·²ç»è¿”å›ï¼ˆè¿”å›ä¹‹åä¹‹å‰å‹å…¥çš„è¿”å›åœ°å€å°±ä¼šè¢«å¼¹å‡ºï¼‰ï¼Œä½†æ˜¯æ ˆå¸§è¿˜åœ¨ï¼Œæ‰€ä»¥åˆ†é…çš„å±€éƒ¨å˜é‡è¿˜åœ¨ movq (%rsp) , %rdx subq 8(%rsp) ,%rdx imulq %rdx , %rax addq $16 , %rsp\t;æ­¤æ—¶æ ˆå¸§ä¸å­˜åœ¨ï¼Œä¼šè¢«åæ¥çš„dataè¦†ç›–æ‰ ret æ ˆå¸§åˆ†é…åˆ°åº•æ‹¿æ¥å¹²å˜›äº†ï¼Ÿ\nçœ‹ä¸‹å›¾ï¼š\nåˆ†é…æ ˆå¸§ï¼Œå…ˆç”¨æ¥å­˜æ”¾æœ¬æ–¹æ³•è¦ç”¨çš„å±€éƒ¨å˜é‡ï¼Œæ¥ç€æ˜¯å¤šäº6ä¸ªçš„å‚æ•°ä»å³è‡³å·¦ä¾æ¬¡å‹å…¥æ ˆä¸­ï¼Œç„¶åcallï¼Œæ³¨æ„ï¼Œä¸è¦æ··æ·†å±€éƒ¨å˜é‡å’Œä¼ é€’çš„å‚æ•°ï¼Œåœ¨è¢«è°ƒç”¨çš„æ–¹æ³•ä¸­æ˜¯ä¸ä¼šç”¨å‰ä¸€ä¸ªæ–¹æ³•æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡çš„ã€‚\nå¯„å­˜å™¨ä¸­çš„å±€éƒ¨å­˜å‚¨ç©ºé—´ # ğŸ”¹ è¿™äº›å¯„å­˜å™¨ä¸»è¦ç”¨äºä»€ä¹ˆï¼Ÿ # 1. å­˜å‚¨å±€éƒ¨å˜é‡ # ï¼ˆè¿™ä¹Ÿæ˜¯ä¸€ç§å­˜å‚¨å±€éƒ¨å˜é‡çš„æ–¹æ³•ï¼Œæ¯”å¦‚åœ¨forå¾ªç¯ä¸­çš„indexï¼‰\nå¦‚æœä¸€ä¸ªå‡½æ•°æœ‰å±€éƒ¨å˜é‡ï¼Œä½†å¯„å­˜å™¨åˆ†é…ä¸è¶³ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šæŠŠä¸€äº›å˜é‡ä¿å­˜åœ¨è¢«è°ƒç”¨è€…ä¿å­˜å¯„å­˜å™¨é‡Œï¼Œé¿å…é¢‘ç¹è®¿é—®æ ˆï¼ˆæ¯”æ ˆä¸Šçš„å˜é‡è®¿é—®å¿«ï¼‰ã€‚\n2. ç»´æŒé•¿æœŸå˜é‡ï¼ˆLong-lived variablesï¼‰ # å¦‚æœæŸä¸ªå˜é‡åœ¨æ•´ä¸ªå‡½æ•°ç”Ÿå‘½å‘¨æœŸå†…éƒ½ä¼šè¢«ä½¿ç”¨ï¼Œè€Œéä¸´æ—¶æ•°æ®ï¼Œå°±å¯èƒ½æ”¾åœ¨ %rbxã€%r12-%r15 è¿™äº›å¯„å­˜å™¨é‡Œã€‚\n3. ç»´æŠ¤æ ˆå¸§æŒ‡é’ˆï¼ˆ%rbpï¼‰ # è™½ç„¶ç°ä»£ç¼–è¯‘å™¨å¯èƒ½ä¼šçœç•¥æ ˆå¸§æŒ‡é’ˆï¼ˆFrame Pointer Omission, FPOï¼‰ï¼Œä½†åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œ%rbp ä»ç„¶ç”¨äºä¿æŒå½“å‰å‡½æ•°çš„æ ˆåŸºå€ï¼Œå¸®åŠ©å›æº¯è°ƒç”¨æ ˆã€‚\n4. ä¼ é€’è·¨å‡½æ•°è°ƒç”¨çš„å€¼ # åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªå€¼éœ€è¦åœ¨å¤šä¸ªå‡½æ•°è°ƒç”¨ä¹‹é—´ä¿æŒä¸å˜ï¼Œå°±å¯èƒ½å­˜å…¥è¢«è°ƒç”¨è€…ä¿å­˜å¯„å­˜å™¨ï¼Œæ¯”å¦‚ï¼š\né€’å½’å‡½æ•°ä¸­ï¼ŒæŸäº›å‚æ•°å¯èƒ½éœ€è¦è·¨å¤šæ¬¡é€’å½’è°ƒç”¨ä¿æŒä¸å˜ã€‚ åœ¨åç¨‹æˆ–ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ä»£ç é‡Œï¼ŒæŸäº›å¯„å­˜å™¨å¯èƒ½å­˜å‚¨ç‰¹å®šçš„ä»»åŠ¡çŠ¶æ€ã€‚ é€’å½’è¿‡ç¨‹ # åˆ°è¿™é‡Œï¼Œç†è§£é€’å½’è¿‡ç¨‹å°±æ˜¯ç®€å•çš„äº†ï¼Œè°ƒç”¨è‡ªå·±å’Œè°ƒç”¨ä»»ä½•ä¸€ä¸ªè¿‡ç¨‹éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æœ‰è‡ªå·±çš„ç§æœ‰çš„æ ˆå¸§ã€‚\næˆ‘ä»¬éš¾ç†è§£çš„æƒ…å†µæ˜¯æ ˆå¸§é‡Œä¸œè¥¿å¤ªå¤æ‚çš„æƒ…å†µã€‚\næ•°ç»„çš„åˆ†é…å’Œè®¿é—® # 1.æŒ‡é’ˆè®¿é—®ï¼Œå¦‚æœæ˜¯åœ°å€ï¼Œå°±ç”¨leaqåŠ è½½æœ‰æ•ˆåœ°å€ï¼Œå¦‚æœæ˜¯å–å€¼å°±ç”¨movæŒ‡ä»¤å³å¯ã€‚\n2.å¤šç»´æ•°ç»„\n3.å®šé•¿å˜é•¿æ•°ç»„ä»¥åŠç»“æ„ä½“\nå…³äºç¼“å†²åŒºæº¢å‡ºé—®é¢˜ # Cè¯­è¨€åŸºç¡€ # å…³äºä½è¿ç®—çš„æŠ€å·§\nå®å®šä¹‰å‡½æ•°å¤šè¡Œç”¨\\åˆ†å¼€ï¼Œç”¨do {\u0026hellip;\u0026hellip;} while(0)åƒæ‰;ï¼ˆç»†èŠ‚é—®é¢˜ï¼‰\nå†…è”å‡½æ•°ï¼šç±»ä¼¼å®å®šä¹‰ï¼Œè°ƒç”¨çš„å‡½æ•°ä¸è·³è½¬ï¼Œç›´æ¥å±•å¼€ï¼ŒèŠ‚çº¦èµ„æºï¼ˆæ ¹æ®ç¼–è¯‘å™¨çš„æƒ…å†µè€Œå®š)\nstatic inline int(...){......}\t//ä¸€èˆ¬è¿™æ ·å®šä¹‰åœ¨å¤´æ–‡ä»¶é‡Œä½¿ç”¨ å…³äºCè¯­è¨€ä¸å†èµ˜è¿°\næµ®ç‚¹æ•°è¯¦è§£ # æµ®ç‚¹æ•°å­˜å‚¨å½¢å¼ # ï¼ˆå°æ•°ç‚¹æµ®åŠ¨ï¼‰è¿›åˆ¶è½¬æ¢ï¼ˆæ•°å­—ç”µè·¯å†…å®¹ï¼‰\n[!NOTE]\nIEEE754å…¸ä¸­å…¸\nè¿™é‡Œçš„å°¾æ•°å…¶å®æŒ‡çš„å°±æ˜¯å°æ•°ç‚¹ä¹‹åçš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼š\næ¯”å¦‚2.5 = 10.1b\nå³ $$ 2.5 = 1.01*2^1 $$\n[!NOTE]\nè¿™æ˜¯ä¸€ä¸ªè§„æ ¼åŒ–çš„æµ®ç‚¹æ•°ï¼Œæ‰€è°“è§„æ ¼åŒ–ï¼Œæˆ‘ä»¬é»˜è®¤ä¸€ä¸ªæµ®ç‚¹æ•°æ˜¯å¤§äº1çš„ï¼Œå³æœ‰ä¸€ä¸ªéšå«çš„å‰å¯¼1,æˆ‘ä»¬åªåœ¨å°¾æ•°çš„23ä½ä¸­å­˜å‚¨å°æ•°ç‚¹çš„éƒ¨åˆ†å³å¯ï¼Œä½†æ˜¯å¦‚æœæŒ‡æ•°éƒ¨åˆ†ä¸º0,ä½†æ˜¯å°¾æ•°ä¸ä¸º0,è¿™å°±æ˜¯ä¸€ä¸ªéè§„æ ¼åŒ–çš„æµ®ç‚¹æ•°ï¼Œè®¡ç®—çš„è§„åˆ™å·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œæ­¤æ—¶çš„æŒ‡æ•°ä¸º1-biasï¼Œä¸ºäº†äº§ç”Ÿå¹³æ»‘çš„è¿‡æ¸¡ã€‚\néè§„æ ¼åŒ–æµ®ç‚¹æ•°åŠèˆå…¥çš„é—®é¢˜ # èˆå…¥ï¼šå°±è¿‘èˆå…¥ï¼Œç›¸åŒ0ä¼˜å…ˆ\næŒ‡æ•°éƒ¨åˆ†è¶Šå¤§ï¼Œå¯†åº¦å˜å°ï¼Œç²¾åº¦å°±ä¼šå˜ä½\næµ®ç‚¹æ•°çš„è¿ç®— # å…ˆæŠŠæŒ‡æ•°è®¾ç½®ç›¸åŒï¼Œå†ç›¸åŠ è¿™ä¼šå¯¼è‡´å¤§æ•°åƒæ‰å°æ•°çš„æƒ…å†µäº§ç”Ÿ\né‡‡ç”¨å¦‚ä¸‹çš„ç´¯åŠ ç®—æ³•\næ¯”è¾ƒé—®é¢˜ï¼š0.1 + 0.2 != 0.3ï¼ˆæ— é™ä¸å¾ªç¯å°æ•°ç›¸åŠ å¯¼è‡´çš„ï¼‰\n[!NOTE]\nè¿˜æœ‰ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç‚¹æ˜¯è½¬æ¢ç±»å‹æ—¶å€™çš„æœ€è¿‘å¶æ•°èˆå…¥ï¼ˆé“¶è¡Œå®¶èˆå…¥ï¼‰ï¼Œè¿™æœ‰åˆ©äºå‡å°‘ç´¯ç§¯èˆå…¥çš„è¯¯å·®ã€‚\nè¯¾åä½œä¸š # æ­¤æ—¶æˆ‘ä»¬å»åšCSAPPçš„3ä¸ªlabï¼Œå¹¶ä¸”æŠŠCSAPP2,3ç« çš„è¯¾åä¹ é¢˜éƒ½è§£å†³ä¸€éï¼ˆæˆ‘æ‡’çš„å†™ç¬¬äºŒç« äº†ï¼Œæˆ‘åªå†™ä¸€ä¸‹ç¬¬ä¸‰ç« çš„å†…å®¹ï¼‰\n1.datalab\n2.bomblabï¼ˆgdbçš„ä½¿ç”¨ï¼Œå¾ˆæœ‰éš¾åº¦,æˆ‘è§‰å¾—å¯ä»¥å…ˆå¤šçœ‹çœ‹ä¹¦ï¼Œåšä¸€ä¸‹ç»ƒä¹ å’Œè¯¾åä¹ é¢˜ï¼Œç†è§£ä¹‹åå†å»ä¸Šæ‰‹ï¼‰\ngdbå¸¸ç”¨æŒ‡ä»¤ï¼ˆæ¥è‡ªhttps://arthals.ink/blog/bomb-labä½œä¸ºå‚è€ƒçš„blogï¼‰\np $rax # æ‰“å°å¯„å­˜å™¨ rax çš„å€¼ p $rsp # æ‰“å°æ ˆæŒ‡é’ˆçš„å€¼ p/x $rsp # æ‰“å°æ ˆæŒ‡é’ˆçš„å€¼ï¼Œä»¥åå…­è¿›åˆ¶æ˜¾ç¤º p/d $rsp # æ‰“å°æ ˆæŒ‡é’ˆçš„å€¼ï¼Œä»¥åè¿›åˆ¶æ˜¾ç¤º x/2x $rsp # ä»¥åå…­è¿›åˆ¶æ ¼å¼æŸ¥çœ‹æ ˆæŒ‡é’ˆ %rsp æŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ä¸¤ä¸ªå•ä½ã€‚ x/2d $rsp # ä»¥åè¿›åˆ¶æ ¼å¼æŸ¥çœ‹æ ˆæŒ‡é’ˆ %rsp æŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ä¸¤ä¸ªå•ä½ã€‚ x/2c $rsp # ä»¥å­—ç¬¦æ ¼å¼æŸ¥çœ‹æ ˆæŒ‡é’ˆ %rsp æŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ä¸¤ä¸ªå•ä½ã€‚ x/s $rsp # æŠŠæ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å½“ä½œ C é£æ ¼å­—ç¬¦ä¸²æ¥æŸ¥çœ‹ã€‚ x/b $rsp # æ£€æŸ¥æ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ 1 å­—èŠ‚ã€‚ x/h $rsp # æ£€æŸ¥æ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ 2 å­—èŠ‚ï¼ˆåŠå­—ï¼‰ã€‚ x/w $rsp # æ£€æŸ¥æ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ 4 å­—èŠ‚ï¼ˆå­—ï¼‰ã€‚ x/g $rsp # æ£€æŸ¥æ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ 8 å­—èŠ‚ï¼ˆåŒå­—ï¼‰ã€‚ info registers # æ‰“å°æ‰€æœ‰å¯„å­˜å™¨çš„å€¼ info breakpoints # æ‰“å°æ‰€æœ‰æ–­ç‚¹çš„ä¿¡æ¯ delete breakpoints 1 # åˆ é™¤ç¬¬ä¸€ä¸ªæ–­ç‚¹ï¼Œå¯ä»¥ç®€å†™ä¸º d 1 3.attacklabï¼ˆæ¨¡æ‹Ÿæ”»å‡»ï¼‰\n[!NOTE]\nä¸Šè¿°å·¥ä½œä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œä½†æ˜¯æ¬²é€Ÿåˆ™ä¸è¾¾ï¼Œå¦‚æœéš¾ä»¥ä¸‹æ‰‹ï¼Œä½ å¯ä»¥å‚è€ƒCSDIYä¸Šçš„ä¸€äº›æ¨èåšå®¢ã€‚\né“¾æ¥ç®€å•è§£è¯» # Static Linking # å¯ä»¥ç†è§£æ˜¯æ€ä¹ˆæŠŠä½ å†™çš„å¤šæ–‡ä»¶ç¨‹åºæ•´åˆåœ¨ä¸€èµ·è¿è¡Œã€‚\nå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶çš„åˆ†æ(Relocatable File) # å•ä¸ªæ–‡ä»¶æ±‡ç¼–ä¹‹åï¼Œåç¼€ä¸º.oçš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ã€‚\nï¼ˆç”¨ä»¥ä¸‹çš„ä¸¤ä¸ªç¨‹åºï¼‰\nreadelf -a main.o\t//åˆ†æelfæ–‡ä»¶å†…å®¹ hexdump -C main.o\t//ç›´æ¥æŸ¥çœ‹æ–‡ä»¶çš„äºŒè¿›åˆ¶ä¿¡æ¯ ç¬¦å·è¡¨ä¿¡æ¯ # å¼±ç¬¦å·å’Œå¼ºç¬¦å· # å¯æ‰§è¡Œæ–‡ä»¶ # æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„Program Headerï¼ˆå¯æ‰§è¡Œæ–‡ä»¶æ˜¯æ€ä¹ˆè¢«åŠ è½½æ‰§è¡Œçš„ï¼Ÿï¼‰\nProgram Headers: Type Offset VirtAddr PhysAddr FileSiz MemSiz Flg Align LOAD 0x001020 0x00800020 0x00800020 0x00198 0x00198 R E 0x1000 LOAD 0x002000 0x00801000 0x00801000 0x00038 0x00050 RW 0x1000 GNU_STACK 0x000000 0x00000000 0x00000000 0x00000 0x00000 RW 0x10 Section to Segment mapping: Segment Sections... 00 .text .rodata 01 .data .bss 02 é™æ€é“¾æ¥çš„è¿‡ç¨‹ # /* Simple linker script for os user-level programs. See the GNU ld \u0026#39;info\u0026#39; manual (\u0026#34;info ld\u0026#34;) to learn the syntax. */ //ä¸€ä¸ªç®€å•çš„linkerè„šæœ¬ OUTPUT_FORMAT(\u0026#34;elf32-i386\u0026#34;, \u0026#34;elf32-i386\u0026#34;, \u0026#34;elf32-i386\u0026#34;)\t//è¾“å‡ºæ ¼å¼ OUTPUT_ARCH(i386)\t//æ¶æ„ç±»å‹ ENTRY(main)\t//ç¨‹åºçš„å…¥å£ç‚¹ï¼ˆmainå‡½æ•°ï¼‰ SECTIONS { /* Load programs at this address: \u0026#34;.\u0026#34; means the current address */ //åœ¨è¿™ä¸ªåœ°å€å¯¹ç¨‹åºè¿›è¡ŒåŠ è½½ . = 0x800020; //ä»¥ä¸‹éƒ½æ˜¯æŠŠæ¯ä¸ªç›®æ ‡æ–‡ä»¶ä¸­çš„ç›¸åŒçš„æ®µåˆå¹¶åˆ°æ–°çš„æ®µ .text : { *(.text .stub .text.* .gnu.linkonce.t.*) } PROVIDE(etext = .); /* Define the \u0026#39;etext\u0026#39; symbol to this value */ .rodata : { *(.rodata .rodata.* .gnu.linkonce.r.*) } /* Adjust the address for the data segment to the next page */ //è½¬é¡µè¿›è¡Œå­˜å‚¨ï¼Œä»¥ä¸Šçš„é¡µå°±å¯ä»¥è®¾ç½®æˆroçš„ä¸€ä¸ªé¡µ . = ALIGN(0x1000); .data : { *(.data) } //è®°å½•ä¸‹æ¥ï¼ŒæŠŠ.bssæ®µè®¾ç½®æˆ0 PROVIDE(edata = .); .bss : { *(.bss) } PROVIDE(end = .); /DISCARD/ : { *(.eh_frame .note.GNU-stack .comment) } } é‡å®šä½ä¿¡æ¯ # ","date":"10 March 2025","externalUrl":null,"permalink":"/tech/computerorgnization/","section":"Tech","summary":"","title":"ComputerOrgnization","type":"tech"},{"content":" CSAPP:BombLab # [!NOTE]\næœ¬æ–‡ä¸»è¦å‚è€ƒåšå®¢ï¼šarthals.inkï¼Œå¦‚æœä½ è¦å­¦ä¹ æ–¹æ³•ï¼Œä½ åªè¦çœ‹TAå†™çš„å°±å¯ä»¥äº†ï¼Œæˆ‘åªçœ‹äº†å‰ä¸¤å±‚ï¼Œ åªæ˜¯åšä¸ªè®°å½•ï¼Œæˆ‘è®¤ä¸ºå¯¹äºæˆ‘æ¥è¯´å¾ˆå¥½çš„è§£å†³é—®é¢˜æ–¹å¼å°±æ˜¯å†™æ³¨é‡Š(æ‰€ä»¥æˆ‘è¿™é‡Œæœ‰é€è¡Œçš„æ³¨é‡Š)ã€‚\ngdbæŒ‡ä»¤ï¼š\np $rax # æ‰“å°å¯„å­˜å™¨ rax çš„å€¼ p $rsp # æ‰“å°æ ˆæŒ‡é’ˆçš„å€¼ p/x $rsp # æ‰“å°æ ˆæŒ‡é’ˆçš„å€¼ï¼Œä»¥åå…­è¿›åˆ¶æ˜¾ç¤º p/d $rsp # æ‰“å°æ ˆæŒ‡é’ˆçš„å€¼ï¼Œä»¥åè¿›åˆ¶æ˜¾ç¤º x/2x $rsp # ä»¥åå…­è¿›åˆ¶æ ¼å¼æŸ¥çœ‹æ ˆæŒ‡é’ˆ %rsp æŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ä¸¤ä¸ªå•ä½ã€‚ x/2d $rsp # ä»¥åè¿›åˆ¶æ ¼å¼æŸ¥çœ‹æ ˆæŒ‡é’ˆ %rsp æŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ä¸¤ä¸ªå•ä½ã€‚ x/2c $rsp # ä»¥å­—ç¬¦æ ¼å¼æŸ¥çœ‹æ ˆæŒ‡é’ˆ %rsp æŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ä¸¤ä¸ªå•ä½ã€‚ x/s $rsp # æŠŠæ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å½“ä½œ C é£æ ¼å­—ç¬¦ä¸²æ¥æŸ¥çœ‹ã€‚ x/b $rsp # æ£€æŸ¥æ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ 1 å­—èŠ‚ã€‚ x/h $rsp # æ£€æŸ¥æ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ 2 å­—èŠ‚ï¼ˆåŠå­—ï¼‰ã€‚ x/w $rsp # æ£€æŸ¥æ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ 4 å­—èŠ‚ï¼ˆå­—ï¼‰ã€‚ x/g $rsp # æ£€æŸ¥æ ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä½ç½® M[%rsp] å¼€å§‹çš„ 8 å­—èŠ‚ï¼ˆåŒå­—ï¼‰ã€‚ info registers # æ‰“å°æ‰€æœ‰å¯„å­˜å™¨çš„å€¼ info breakpoints # æ‰“å°æ‰€æœ‰æ–­ç‚¹çš„ä¿¡æ¯ delete breakpoints 1 # åˆ é™¤ç¬¬ä¸€ä¸ªæ–­ç‚¹ï¼Œå¯ä»¥ç®€å†™ä¸º d 1 phase1: # æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å¯¹æ¯”ä¸€ä¸‹å­—ç¬¦ä¸²ï¼Œç†Ÿæ‚‰ä¸€ä¸‹ã€‚\n00000000000015ab \u0026lt;phase_1\u0026gt;: 15ab:\tf3 0f 1e fa endbr64 15af:\t48 83 ec 08 sub $0x8,%rsp 15b3:\t48 8d 35 f2 1a 00 00 lea 0x1af2(%rip),%rsi # è¿™å¾ˆç®€å•ï¼Œä½ åªè¦æŸ¥çœ‹rsié‡Œé¢å­˜æ”¾äº†ä»€ä¹ˆä¸œè¥¿å°±å¯ä»¥ 15ba:\te8 f3 05 00 00 call 1bb2 \u0026lt;strings_not_equal\u0026gt; 15bf:\t85 c0 test %eax,%eax 15c1:\t75 05 jne 15c8 \u0026lt;phase_1+0x1d\u0026gt; 15c3:\t48 83 c4 08 add $0x8,%rsp 15c7:\tc3 ret 15c8:\te8 f9 06 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 15cd:\teb f4 jmp 15c3 \u0026lt;phase_1+0x18\u0026gt; phase2: # å…ˆçœ‹phase_2çš„ä»£ç ï¼Œè¿™æ˜¯å…¸å‹çš„å¾ªç¯\n00000000000015cf \u0026lt;phase_2\u0026gt;: 15cf:\tf3 0f 1e fa endbr64 # ç”¨æ¥é˜²æ­¢ROPæ”»å‡» 15d3:\t55 push %rbp # ä¸¤ä¸ªå±€éƒ¨å˜é‡ 15d4:\t53 push %rbx 15d5:\t48 83 ec 28 sub $0x28,%rsp # åˆ†é…äº†40ä¸ªå­—èŠ‚ 15d9:\t64 48 8b 04 25 28 00 mov %fs:0x28,%rax # é‡‘ä¸é›€å€¼ï¼Œç”¨æ¥é˜²æ­¢æ¶æ„ä¿®æ”¹ 15e0:\t00 00 15e2:\t48 89 44 24 18 mov %rax,0x18(%rsp) # æŠŠé‡‘ä¸é›€å€¼ä¿å­˜èµ·æ¥ï¼Œè¿™æ ·è¢«ä¿®æ”¹çš„æ—¶å€™å°±ä¼šæé†’ 15e7:\t31 c0 xor %eax,%eax # ??? 15e9:\t48 89 e6 mov %rsp,%rsi # æ ˆæŒ‡é’ˆçš„å€¼èµ‹ç»™äº†rsi 15ec:\te8 2d 07 00 00 call 1d1e \u0026lt;read_six_numbers\u0026gt; # è°ƒç”¨ä¸€ä¸ªè¯»å–6ä¸ªæ•°å­—çš„å‡½æ•° 15f1:\t83 3c 24 01 cmpl $0x1,(%rsp) # ç¬¬ä¸€ä¸ªæ•°å­—ä¸º1 15f5:\t75 0a jne 1601 \u0026lt;phase_2+0x32\u0026gt; 15f7:\t48 89 e3 mov %rsp,%rbx # rbxä¸ºå½“å‰æ ˆé¡¶çš„åœ°å€ 15fa:\t48 8d 6c 24 14 lea 0x14(%rsp),%rbp # rbpå­˜æ”¾rsp + 20bytesçš„åœ°å€ 0 4 8 12 16 20åˆšå¥½å…­ä¸ªæ•°å­—ç”¨æ ˆä¼ é€’ 15ff:\teb 10 jmp 1611 \u0026lt;phase_2+0x42\u0026gt; # æ— æ¡ä»¶è·³è½¬1611 1601:\te8 c0 06 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1606:\teb ef jmp 15f7 \u0026lt;phase_2+0x28\u0026gt; 1608:\t48 83 c3 04 add $0x4,%rbx # ç›¸ç­‰çš„æƒ…å†µä¸‹è€ƒå¯Ÿç¬¬äºŒä¸ªå‚æ•°çš„æƒ…å†µ 160c:\t48 39 eb cmp %rbp,%rbx # å¾ªç¯ç»ˆæ­¢æ¡ä»¶ 160f:\t74 10 je 1621 \u0026lt;phase_2+0x52\u0026gt; 1611:\t8b 03 mov (%rbx),%eax # å–ç¬¬ä¸€ä¸ªå‚æ•°åˆ°eax 1613:\t01 c0 add %eax,%eax # eax = eax * 2 1615:\t39 43 04 cmp %eax,0x4(%rbx) # å’Œç¬¬äºŒä¸ªå‚æ•°ä½œæ¯”è¾ƒ 1618:\t74 ee je 1608 \u0026lt;phase_2+0x39\u0026gt; # ç›¸ç­‰ç»§ç»­ï¼Œä¸ç›¸ç­‰çˆ†ç‚¸ 161a:\te8 a7 06 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 161f:\teb e7 jmp 1608 \u0026lt;phase_2+0x39\u0026gt; 1621:\t48 8b 44 24 18 mov 0x18(%rsp),%rax 1626:\t64 48 2b 04 25 28 00 sub %fs:0x28,%rax 162d:\t00 00 162f:\t75 07 jne 1638 \u0026lt;phase_2+0x69\u0026gt; 1631:\t48 83 c4 28 add $0x28,%rsp 1635:\t5b pop %rbx 1636:\t5d pop %rbp 1637:\tc3 ret 1638:\te8 13 fc ff ff call 1250 \u0026lt;__stack_chk_fail@plt\u0026gt; å†çœ‹å®ƒè°ƒç”¨çš„è¯»å–å…­ä¸ªæ•°å­—çš„function\n0000000000001d1e \u0026lt;read_six_numbers\u0026gt;: 1d1e:\tf3 0f 1e fa endbr64 1d22:\t48 83 ec 08 sub $0x8,%rsp # å†åˆ†é…8ä¸ªå­—èŠ‚ 1d26:\t48 89 f2 mov %rsi,%rdx # è®°ä½rsiæ˜¯ä¸Šä¸€å±‚æ ˆé¡¶çš„ä½ç½®æ”¾åˆ°rdxè¿™é‡Œ 1d29:\t48 8d 4e 04 lea 0x4(%rsi),%rcx # æŠŠè¿™äº›å‚æ•°ç”¨å¯„å­˜å™¨å‘ä¸‹ä¸€ä¸ªsscanfä¼ é€’ 1d2d:\t48 8d 46 14 lea 0x14(%rsi),%rax 1d31:\t50 push %rax 1d32:\t48 8d 46 10 lea 0x10(%rsi),%rax 1d36:\t50 push %rax 1d37:\t4c 8d 4e 0c lea 0xc(%rsi),%r9 1d3b:\t4c 8d 46 08 lea 0x8(%rsi),%r8 1d3f:\t48 8d 35 b6 15 00 00 lea 0x15b6(%rip),%rsi # 32fc \u0026lt;array.0+0x1fc\u0026gt; è¿™é‡Œåº”è¯¥æ˜¯æˆ‘ä»¬è¾“å…¥çš„æ•°å­— int sscanf(const char *str, const char *format, ...); 1d46:\tb8 00 00 00 00 mov $0x0,%eax # åˆ†æä¸€ä¸‹sscanfçš„å‚æ•° rdi:å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„string,rsiæ˜¯æ ¼å¼,å°±æ˜¯\u0026#34;%d %d %d %d %d %d\u0026#34;,rdxæ˜¯ç¬¬ä¸€ä¸ªæ•°,rcxæ˜¯ç¬¬äºŒä¸ªæ•°,r8æ˜¯ç¬¬ä¸‰ä¸ªæ•°,r9æ˜¯ç¬¬å››ä¸ªæ•°,ç°åœ¨å¯„å­˜å™¨ä¸å¤Ÿç”¨ï¼Œç”¨æ ˆä¼ é€’å‚æ•°ï¼Œå¹¶ä¸”æ˜¯ä»å³å‘å·¦çš„è¿™å°±å¾ˆå¥½ç†è§£äº† 1d4b:\te8 b0 f5 ff ff call 1300 \u0026lt;__isoc99_sscanf@plt\u0026gt; #è¿™é‡Œè¦è°ƒç”¨sscanfå‡½æ•° 1d50:\t48 83 c4 10 add $0x10,%rsp 1d54:\t83 f8 05 cmp $0x5,%eax 1d57:\t7e 05 jle 1d5e \u0026lt;read_six_numbers+0x40\u0026gt; 1d59:\t48 83 c4 08 add $0x8,%rsp 1d5d:\tc3 ret 1d5e:\te8 63 ff ff ff call 1cc6 \u0026lt;explode_bomb\u0026gt; phase3: # æœ¬å±‚å°±æ˜¯å…³äºä¸€äº›æ¡ä»¶çš„åˆ¤æ–­(å¤§æ¦‚å°±æ˜¯switchè¯­å¥)ï¼ˆç†è§£æå‡äº†ï¼Œä¹‹å‰è‡ªå·±è‚¯å®šæ²¡åŠæ³•åšå‡ºæ¥çš„ï¼‰ï¼š\n000000000000163d \u0026lt;phase_3\u0026gt;: # æé†’æ˜¯å…³äºswitchè¯­å¥,ä¸æ˜¯å“¥ä»¬æ˜¯å¦æœ‰äº›å¤ªé•¿äº† 163d:\tf3 0f 1e fa endbr64 # æˆ‘ä»¬æŒ‰ç…§çº¿æ€§çš„æ–¹æ³•å…ˆèµ°ä¸€éç¨‹åº 1641:\t48 83 ec 28 sub $0x28,%rsp # åˆ†é…äº†40ä¸ªå­—èŠ‚ 1645:\t64 48 8b 04 25 28 00 mov %fs:0x28,%rax # é‡‘ä¸é›€å€¼ 164c:\t00 00 164e:\t48 89 44 24 18 mov %rax,0x18(%rsp) # é‡‘ä¸é›€å€¼æ”¾åœ¨24ä¸ªå­—èŠ‚å¼€å§‹çš„ä½ç½® 1653:\t31 c0 xor %eax,%eax # æ£€æŸ¥ 1655:\t48 8d 4c 24 0f lea 0xf(%rsp),%rcx # rcx = rsp + 15 å ä¸€ä¸ªå­—èŠ‚ ç¬¬å››ä¸ªå‚æ•° a2 165a:\t48 8d 54 24 10 lea 0x10(%rsp),%rdx # rdx = rsp + 16 å å››ä¸ªå­—èŠ‚ ç¬¬ä¸‰ä¸ªå‚æ•° a1 165f:\t4c 8d 44 24 14 lea 0x14(%rsp),%r8 # r8 = rsp + 20 å å››ä¸ªå­—èŠ‚ ç¬¬äº”ä¸ªå‚æ•° a3 1664:\t48 8d 35 5e 1a 00 00 lea 0x1a5e(%rip),%rsi # 30c9 \u0026lt;_IO_stdin_used+0xc9\u0026gt; è¿™é‡Œçš„rsiæ˜¯\u0026#34;%d %c %d\u0026#34; 166b:\te8 90 fc ff ff call 1300 \u0026lt;__isoc99_sscanf@plt\u0026gt; 1670:\t83 f8 02 cmp $0x2,%eax # sscanfçš„è¿”å›å€¼æ˜¯è¯»å–çš„å‚æ•°çš„ä¸ªæ•°,è‹¥å‚æ•°å°äº2é”™ 1673:\t7e 20 jle 1695 \u0026lt;phase_3+0x58\u0026gt; 1675:\t83 7c 24 10 07 cmpl $0x7,0x10(%rsp) # a1å¤§äº7å°±çˆ†ç‚¸ 167a:\t0f 87 0a 01 00 00 ja 178a \u0026lt;phase_3+0x14d\u0026gt; 1680:\t8b 44 24 10 mov 0x10(%rsp),%eax # rax = a1(æˆ‘ä»¬å…ˆå‡è®¾a1 = 6) 1684:\t48 8d 15 55 1a 00 00 lea 0x1a55(%rip),%rdx # 30e0 \u0026lt;_IO_stdin_used+0xe0\u0026gt; rdxä¸­åŠ è½½äº†ä¸€ä¸ª-68? 168b:\t48 63 04 82 movslq (%rdx,%rax,4),%rax # rax = 4 * rax + rdx 168f:\t48 01 d0 add %rdx,%rax # rax = rax + rdx(å¯èƒ½æ˜¯è·³è¡¨ä½ç½®çš„è®¡ç®—ï¼Ÿ) 1692:\t3e ff e0 notrack jmp *%rax # å…¶ä½œç”¨æ˜¯ è·³è½¬åˆ° RAX å¯„å­˜å™¨å­˜å‚¨çš„åœ°å€ï¼Œå¹¶ä¸”ä¸è®°å½• return address åˆ° å½±å­è°ƒç”¨æ ˆï¼ˆShadow Stack 1695:\te8 2c 06 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 169a:\teb d9 jmp 1675 \u0026lt;phase_3+0x38\u0026gt; 169c:\tb8 77 00 00 00 mov $0x77,%eax 16a1:\t81 7c 24 14 a8 01 00 cmpl $0x1a8,0x14(%rsp) 16a8:\t00 16a9:\t0f 84 e5 00 00 00 je 1794 \u0026lt;phase_3+0x157\u0026gt; 16af:\te8 12 06 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 16b4:\tb8 77 00 00 00 mov $0x77,%eax 16b9:\te9 d6 00 00 00 jmp 1794 \u0026lt;phase_3+0x157\u0026gt; 16be:\tb8 70 00 00 00 mov $0x70,%eax 16c3:\t81 7c 24 14 bc 00 00 cmpl $0xbc,0x14(%rsp) 16ca:\t00 16cb:\t0f 84 c3 00 00 00 je 1794 \u0026lt;phase_3+0x157\u0026gt; 16d1:\te8 f0 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 16d6:\tb8 70 00 00 00 mov $0x70,%eax 16db:\te9 b4 00 00 00 jmp 1794 \u0026lt;phase_3+0x157\u0026gt; 16e0:\tb8 78 00 00 00 mov $0x78,%eax 16e5:\t81 7c 24 14 40 03 00 cmpl $0x340,0x14(%rsp) 16ec:\t00 16ed:\t0f 84 a1 00 00 00 je 1794 \u0026lt;phase_3+0x157\u0026gt; 16f3:\te8 ce 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 16f8:\tb8 78 00 00 00 mov $0x78,%eax 16fd:\te9 92 00 00 00 jmp 1794 \u0026lt;phase_3+0x157\u0026gt; 1702:\tb8 6e 00 00 00 mov $0x6e,%eax 1707:\t83 7c 24 14 39 cmpl $0x39,0x14(%rsp) 170c:\t0f 84 82 00 00 00 je 1794 \u0026lt;phase_3+0x157\u0026gt; 1712:\te8 af 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1717:\tb8 6e 00 00 00 mov $0x6e,%eax 171c:\teb 76 jmp 1794 \u0026lt;phase_3+0x157\u0026gt; 171e:\tb8 74 00 00 00 mov $0x74,%eax 1723:\t81 7c 24 14 c4 03 00 cmpl $0x3c4,0x14(%rsp) 172a:\t00 172b:\t74 67 je 1794 \u0026lt;phase_3+0x157\u0026gt; 172d:\te8 94 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1732:\tb8 74 00 00 00 mov $0x74,%eax 1737:\teb 5b jmp 1794 \u0026lt;phase_3+0x157\u0026gt; 1739:\tb8 67 00 00 00 mov $0x67,%eax 173e:\t81 7c 24 14 95 03 00 cmpl $0x395,0x14(%rsp) 1745:\t00 1746:\t74 4c je 1794 \u0026lt;phase_3+0x157\u0026gt; 1748:\te8 79 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 174d:\tb8 67 00 00 00 mov $0x67,%eax 1752:\teb 40 jmp 1794 \u0026lt;phase_3+0x157\u0026gt; 1754:\tb8 71 00 00 00 mov $0x71,%eax # a1å°äº7ä¼šè·³è½¬åˆ°è¿™é‡Œ eax = 71,è¿™é‡Œå·²ç»é‡æ–°èµ‹å€¼äº† 1759:\t81 7c 24 14 f2 01 00 cmpl $0x1f2,0x14(%rsp) # çœ‹ç¬¬ä¸‰ä¸ªå‚æ•°çš„å€¼,ä¸ç­‰äº498å°±çˆ†ç‚¸ 1760:\t00 1761:\t74 31 je 1794 \u0026lt;phase_3+0x157\u0026gt; 1763:\te8 5e 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1768:\tb8 71 00 00 00 mov $0x71,%eax 176d:\teb 25 jmp 1794 \u0026lt;phase_3+0x157\u0026gt; 176f:\tb8 6e 00 00 00 mov $0x6e,%eax 1774:\t81 7c 24 14 83 03 00 cmpl $0x383,0x14(%rsp) 177b:\t00 177c:\t74 16 je 1794 \u0026lt;phase_3+0x157\u0026gt; 177e:\te8 43 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1783:\tb8 6e 00 00 00 mov $0x6e,%eax 1788:\teb 0a jmp 1794 \u0026lt;phase_3+0x157\u0026gt; 178a:\te8 37 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 178f:\tb8 6e 00 00 00 mov $0x6e,%eax 1794:\t38 44 24 0f cmp %al,0xf(%rsp) # ç­‰äº498çš„æƒ…å†µä¸‹æ¥åˆ°è¿™é‡Œ,çœ‹è¾“å…¥çš„å­—ç¬¦å’Œalçš„å€¼æ˜¯å¦ç›¸ç­‰ï¼ŒæŸ¥ASCIIè¿™é‡Œåº”è¯¥æ˜¯G 1798:\t75 15 jne 17af \u0026lt;phase_3+0x172\u0026gt; # ä¸ç›¸ç­‰çˆ†ç‚¸ 179a:\t48 8b 44 24 18 mov 0x18(%rsp),%rax # ç¬¬äºŒä¸ªæ˜¯qï¼ŒOKç»“æŸï¼Œå®Œå…¨ä¸çŸ¥é“å…·ä½“çš„switchä½†æ˜¯èƒ½åš 179f:\t64 48 2b 04 25 28 00 sub %fs:0x28,%rax 17a6:\t00 00 17a8:\t75 0c jne 17b6 \u0026lt;phase_3+0x179\u0026gt; 17aa:\t48 83 c4 28 add $0x28,%rsp 17ae:\tc3 ret 17af:\te8 12 05 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 17b4:\teb e4 jmp 179a \u0026lt;phase_3+0x15d\u0026gt; 17b6:\te8 95 fa ff ff call 1250 \u0026lt;__stack_chk_fail@plt\u0026gt; phase4: # å…³äºé€’å½’å‡½æ•°ï¼Ÿ\nè¿™æ˜¯phase4ä¸­è°ƒç”¨çš„æ–¹æ³•ï¼š\n00000000000017bb \u0026lt;func4\u0026gt;: # å¼€å§‹çš„å‚æ•° edi:a1(x1) esi:0(x2) edx:14(x3) è®¾è¿”å›å€¼ä¸ºx 17bb:\tf3 0f 1e fa endbr64 # è¿™åº”è¯¥æ˜¯ä¸€ä¸ªé€’å½’å‡½æ•° 17bf:\t53 push %rbx # ä¸´æ—¶å˜é‡ (temp) 17c0:\t89 d0 mov %edx,%eax # x = x3 17c2:\t29 f0 sub %esi,%eax # x -= x2 17c4:\t89 c3 mov %eax,%ebx # temp = x 17c6:\tc1 eb 1f shr $0x1f,%ebx # è¿™é‡Œç›¸å½“äºæ˜¯å–äº†tempçš„ç¬¦å· 17c9:\t01 c3 add %eax,%ebx # temp += x 17cb:\td1 fb sar %ebx # temp /= 2(è¿™é‡Œå°±æ˜¯é»˜è®¤çœç•¥äº†1,æ„šè ¢) 17cd:\t01 f3 add %esi,%ebx # temp += x2 17cf:\t39 fb cmp %edi,%ebx # æ¯”è¾ƒå’Œx1ç›¸ä¸ç›¸ç­‰ 17d1:\t7f 06 jg 17d9 \u0026lt;func4+0x1e\u0026gt; # å¦‚æœå¤§äº\u0026gt; 17d3:\t7c 10 jl 17e5 \u0026lt;func4+0x2a\u0026gt; # å¦‚æœå°äº\u0026lt; 17d5:\t89 d8 mov %ebx,%eax # x = temp 17d7:\t5b pop %rbx 17d8:\tc3 ret 17d9:\t8d 53 ff lea -0x1(%rbx),%edx # å¤§äºx1çš„æƒ…å†µ x3 = temp - 1 17dc:\te8 da ff ff ff call 17bb \u0026lt;func4\u0026gt; # é€’å½’è°ƒç”¨ 17e1:\t01 c3 add %eax,%ebx # temp += x 17e3:\teb f0 jmp 17d5 \u0026lt;func4+0x1a\u0026gt; # è¿”å› 17e5:\t8d 73 01 lea 0x1(%rbx),%esi # å°äºçš„æƒ…å†µ x1 = temp + 1 17e8:\te8 ce ff ff ff call 17bb \u0026lt;func4\u0026gt; # é€’å½’è°ƒç”¨ 17ed:\t01 c3 add %eax,%ebx # temp += x 17ef:\teb e4 jmp 17d5 \u0026lt;func4+0x1a\u0026gt; # è¿”å› 00000000000017f1 \u0026lt;phase_4\u0026gt;: 17f1:\tf3 0f 1e fa endbr64 17f5:\t48 83 ec 18 sub $0x18,%rsp # åˆ†é…24ä¸ªå­—èŠ‚ 17f9:\t64 48 8b 04 25 28 00 mov %fs:0x28,%rax # é‡‘ä¸é›€å€¼ 1800:\t00 00 1802:\t48 89 44 24 08 mov %rax,0x8(%rsp) # æŠŠé‡‘ä¸é›€å€¼æ”¾åˆ°äº†stackä¸Šé¢ 1807:\t31 c0 xor %eax,%eax 1809:\t48 8d 4c 24 04 lea 0x4(%rsp),%rcx # æ ˆä¸Šå‚æ•°ä¼ é€’ ç¬¬å››ä¸ªå‚æ•° 4å­—èŠ‚ a2 180e:\t48 89 e2 mov %rsp,%rdx # ç¬¬ä¸‰ä¸ªå‚æ•° 4å­—èŠ‚ a1 1811:\t48 8d 35 f0 1a 00 00 lea 0x1af0(%rip),%rsi # å‚æ•°æ ¼å¼ï¼š\u0026#34;%d %d\u0026#34; 1818:\te8 e3 fa ff ff call 1300 \u0026lt;__isoc99_sscanf@plt\u0026gt; 181d:\t83 f8 02 cmp $0x2,%eax # æ˜¯å¦è¯»å–æ­£ç¡® 1820:\t75 06 jne 1828 \u0026lt;phase_4+0x37\u0026gt; # ä¸æ­£ç¡®çˆ†ç‚¸ 1822:\t83 3c 24 0e cmpl $0xe,(%rsp) # a1 \u0026lt;= 14ä¸ç„¶çˆ†ç‚¸ 1826:\t76 05 jbe 182d \u0026lt;phase_4+0x3c\u0026gt; 1828:\te8 99 04 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; # a1 \u0026lt;= 14è·³åˆ°è¿™é‡Œ è¿™é‡Œå¤§æ¦‚æ˜¯ä¸ºè°ƒç”¨f4åšå‡†å¤‡ 182d:\tba 0e 00 00 00 mov $0xe,%edx # ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯14 1832:\tbe 00 00 00 00 mov $0x0,%esi # ç¬¬äºŒä¸ªå‚æ•°æ˜¯0 1837:\t8b 3c 24 mov (%rsp),%edi # ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯a1 183a:\te8 7c ff ff ff call 17bb \u0026lt;func4\u0026gt; # è°ƒç”¨äº†f4,é‚£å°±æ˜¯è¯´æˆ‘ä»¬æ ¹æ®f4çš„é€»è¾‘æ¥è®¾ç½®a1çš„è¾“å…¥ 183f:\t83 f8 12 cmp $0x12,%eax # å°†è¿”å›å€¼å’Œ18ä½œæ¯”è¾ƒ 1842:\t75 07 jne 184b \u0026lt;phase_4+0x5a\u0026gt; # ä¸ç›¸åŒå°±çˆ†ç‚¸ 1844:\t83 7c 24 04 12 cmpl $0x12,0x4(%rsp) # æŠŠa2å’Œ18ä½œæ¯”è¾ƒ 1849:\t74 05 je 1850 \u0026lt;phase_4+0x5f\u0026gt; # ä¸ç›¸åŒçˆ†ç‚¸ï¼Œç›¸åŒç»“æŸ 184b:\te8 76 04 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1850:\t48 8b 44 24 08 mov 0x8(%rsp),%rax 1855:\t64 48 2b 04 25 28 00 sub %fs:0x28,%rax 185c:\t00 00 185e:\t75 05 jne 1865 \u0026lt;phase_4+0x74\u0026gt; 1860:\t48 83 c4 18 add $0x18,%rsp 1864:\tc3 ret 1865:\te8 e6 f9 ff ff call 1250 \u0026lt;__stack_chk_fail@plt\u0026gt; æˆ‘å¯¹äºfun4åšäº†é€†å‘ï¼š\n#include\u0026lt;stdio.h\u0026gt; //æ‰‹åŠ¨é€†å‘ä»£ç fun4 int fun4(int num1, int num2, int num3){ int x = num3 - num2; int temp = x; if(temp \u0026lt; 0){ ++temp; } temp /= 2; temp += num2; if(temp \u0026gt; num1){ //è¦æ³¨æ„è°ƒç”¨å®Œæˆä¹‹åè·å–çš„raxçš„ä½¿ç”¨ï¼ˆå› ä¸ºè¿™é‡Œåªè°ƒç”¨ä½†æ²¡æœ‰è·å–å€¼æµªè´¹äº†å¾ˆé•¿æ—¶é—´ï¼‰ return fun4(num1, num2, temp - 1) + temp; }else if(temp \u0026lt; num1){ return fun4(num1, temp + 1, num3) + temp; }else{ return temp; } } //å°±æ˜¯ç»™ä¸€ä¸ªè¾“å…¥ï¼Œä½¿å¾—è¿”å›å€¼ä¸º0x12 int main(){ int num1; //scanf(\u0026#34;%d\u0026#34;, \u0026amp;num1); //å½“è¾“å…¥11æ—¶ï¼Œç­”æ¡ˆä¸º18,ä¹Ÿå°±æ˜¯answer int value = fun4(11, 0, 0xe); printf(\u0026#34;%d\\n\u0026#34;, value); } phase5: # hintï¼šæˆ‘çš„è¾“å…¥å’Œarrayä¹‹é—´çš„è½¬æ¢å…³ç³»,ä¹Ÿä¸æ˜¯å¾ˆéš¾\nphase5:\n000000000000186a \u0026lt;phase_5\u0026gt;: 186a:\tf3 0f 1e fa endbr64 186e:\t53 push %rbx # ä¸€ä¸ªå±€éƒ¨å˜é‡ 186f:\t48 83 ec 10 sub $0x10,%rsp # å¼€äº†16å­—èŠ‚ç©ºé—´ 1873:\t48 89 fb mov %rdi,%rbx # å±€éƒ¨å˜é‡å­˜æ”¾rdi,rdiå°±æ˜¯å­—ç¬¦ä¸²çš„é¦–åœ°å€ 1876:\t64 48 8b 04 25 28 00 mov %fs:0x28,%rax # é‡‘ä¸é›€å€¼ 187d:\t00 00 187f:\t48 89 44 24 08 mov %rax,0x8(%rsp) # æ”¾åœ¨æ ˆä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰8å­—èŠ‚çš„å¯ç”¨ç©ºé—´ 1884:\t31 c0 xor %eax,%eax # æ ¡éªŒ 1886:\te8 06 03 00 00 call 1b91 \u0026lt;string_length\u0026gt; # è°ƒç”¨string_length,è¿™é‡Œåº”è¯¥æ˜¯rdiä½œä¸ºå‚æ•°è¯»å…¥äº†ä¸€ä¸ªstring 188b:\t83 f8 06 cmp $0x6,%eax # è¿”å›å€¼å’Œ6æ¯”è¾ƒï¼Œä¸ç›¸ç­‰çˆ†ç‚¸ï¼Œè¾“å…¥çš„å­—ç¬¦ä¸²çš„é•¿åº¦è¦æ˜¯6æ‰å¯ä»¥ 188e:\t75 55 jne 18e5 \u0026lt;phase_5+0x7b\u0026gt; 1890:\tb8 00 00 00 00 mov $0x0,%eax # eax = 0ï¼Ÿä¸‹é¢å¤§æ¦‚æ˜¯ä¸ºstrings_not_equalåšå‡†å¤‡ï¼Œä¸ç›¸ç­‰çˆ†ç‚¸ 1895:\t48 8d 0d 64 18 00 00 lea 0x1864(%rip),%rcx # maduiersnfotvbylWow! You\u0026#39;ve defused the secret stage! 189c:\t0f b6 14 03 movzbl (%rbx,%rax,1),%edx # å°±æ˜¯æˆ‘è¾“å…¥æ•°å­—,ä»ä¸Šé¢è¿™ä¸ªstirngä¸­æ‰¾å€¼ï¼Œæ„é€ ä¸€ä¸ªrdi 18a0:\t83 e2 0f and $0xf,%edx 18a3:\t0f b6 14 11 movzbl (%rcx,%rdx,1),%edx 18a7:\t88 54 04 01 mov %dl,0x1(%rsp,%rax,1) 18ab:\t48 83 c0 01 add $0x1,%rax 18af:\t48 83 f8 06 cmp $0x6,%rax # raxå°±æ˜¯ä¸€ä¸ªindexä½œä¸ºå¾ªç¯æ§åˆ¶é‡ 18b3:\t75 e7 jne 189c \u0026lt;phase_5+0x32\u0026gt; 18b5:\tc6 44 24 07 00 movb $0x0,0x7(%rsp) # æœ€åä¸ºæˆ‘ä»¬æ„é€ çš„å­—ç¬¦ä¸²æ·»åŠ äº†ä¸€ä¸ªç»“æŸç¬¦å· 18ba:\t48 8d 7c 24 01 lea 0x1(%rsp),%rdi 18bf:\t48 8d 35 0c 18 00 00 lea 0x180c(%rip),%rsi # *rsi = \u0026#34;bruins\u0026#34; é€šè¿‡ä¸Šé¢çš„æ“ä½œï¼Œ*rdiè¦ç­‰äº\u0026#34;bruins\u0026#34;æ€ä¹ˆæ“ä½œï¼Ÿ 18c6:\te8 e7 02 00 00 call 1bb2 \u0026lt;strings_not_equal\u0026gt; # æ„æ€å°±æ˜¯ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸ç›¸åŒå°±çˆ†ç‚¸ 18cb:\t85 c0 test %eax,%eax 18cd:\t75 1d jne 18ec \u0026lt;phase_5+0x82\u0026gt; 18cf:\t48 8b 44 24 08 mov 0x8(%rsp),%rax 18d4:\t64 48 2b 04 25 28 00 sub %fs:0x28,%rax 18db:\t00 00 18dd:\t75 14 jne 18f3 \u0026lt;phase_5+0x89\u0026gt; 18df:\t48 83 c4 10 add $0x10,%rsp 18e3:\t5b pop %rbx 18e4:\tc3 ret 18e5:\te8 dc 03 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 18ea:\teb a4 jmp 1890 \u0026lt;phase_5+0x26\u0026gt; 18ec:\te8 d5 03 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 18f1:\teb dc jmp 18cf \u0026lt;phase_5+0x65\u0026gt; 18f3:\te8 58 f9 ff ff call 1250 \u0026lt;__stack_chk_fail@plt\u0026gt; æˆ‘ä»¬ä¸å¿…ç»†ç©¶å®ƒè°ƒç”¨çš„ä¸¤ä¸ªæ–¹æ³•çš„å…·ä½“å®ç°äº†ï¼Œå°±å’Œå‡½æ•°åå­—ä¸€æ ·ã€‚æˆ‘è¾“å…¥çš„stringæ˜¯\u0026quot;M63487\u0026quot;,å› ä¸ºå®é™…ä¸Šä¼šå’Œ0xfä½œä¸è¿ç®—ï¼Œæ‰€ä»¥æ¯ä¸ªå­—ç¬¦éƒ½æ˜¯å¯é€‰çš„ã€‚\nphase6: # [!CAUTION]\nåº”è¯¥æ˜¯æœ€éš¾çš„ä¸€å±‚äº†ï¼Œhintï¼šé“¾è¡¨ï¼Œé‚£å°±è¦ç”¨åˆ°ç»“æ„ä½“äº†å§ã€‚ï¼ˆåšå®Œï¼šå…¶å®è¿˜å¥½ï¼Œåªè¦ä½ ç†è§£å®ƒåœ¨å¹²ä»€ä¹ˆã€‚ï¼‰\n00000000000018f8 \u0026lt;phase_6\u0026gt;: 18f8:\tf3 0f 1e fa endbr64 # å…³äºé“¾è¡¨æ“ä½œ,æœ€é€†å¤©çš„ä¸€å±‚ï¼Œå­©å­ä»¬ 18fc:\t41 57 push %r15 # 6ä¸ªå±€éƒ¨å˜é‡,éƒ½æ˜¯æ‹¿æ¥å¹²å˜›çš„ï¼Ÿï¼Ÿï¼Ÿ 18fe:\t41 56 push %r14 1900:\t41 55 push %r13 1902:\t41 54 push %r12 1904:\t55 push %rbp 1905:\t53 push %rbx 1906:\t48 83 ec 78 sub $0x78,%rsp # åˆ†é…120ä¸ªbytes 190a:\t64 48 8b 04 25 28 00 mov %fs:0x28,%rax # é‡‘ä¸é›€å€¼ 1911:\t00 00 1913:\t48 89 44 24 68 mov %rax,0x68(%rsp) # æ”¾åˆ°æ ˆä¸Šï¼Œæœ‰104ä¸ªbytesæ˜¯å¯ç”¨çš„ 1918:\t31 c0 xor %eax,%eax # æ£€æµ‹é‡‘ä¸é›€å€¼ 191a:\t4c 8d 74 24 10 lea 0x10(%rsp),%r14 # æ­¤æ—¶r14å­˜æ”¾çš„æ˜¯rsp + 16çš„åœ°å€ 191f:\t4c 89 74 24 08 mov %r14,0x8(%rsp) # æŠŠrsp + 16çš„åœ°å€æ”¾åœ¨rsp + 8çš„ä½ç½® 1924:\t4c 89 f6 mov %r14,%rsi # æŠŠrsp + 16çš„åœ°å€ä½œä¸ºç¬¬äºŒä¸ªå‚æ•° 1927:\te8 f2 03 00 00 call 1d1e \u0026lt;read_six_numbers\u0026gt; # è¯»å–äº†å…­ä¸ªæ•°å­— rsp + 16 20 24 28 32 36æ”¾åœ¨è¿™å…­ä¸ªä½ç½® 192c:\t4d 89 f4 mov %r14,%r12 # r12ä¸­æ”¾ rsp + 16çš„åœ°å€ 192f:\t41 bf 01 00 00 00 mov $0x1,%r15d # r15 = 1 1935:\t4d 89 f5 mov %r14,%r13 # r13ä¸­æ”¾ rsp + 16çš„åœ°å€ 1938:\te9 c6 00 00 00 jmp 1a03 \u0026lt;phase_6+0x10b\u0026gt; # è·³è½¬ 193d:\te8 84 03 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1942:\te9 ce 00 00 00 jmp 1a15 \u0026lt;phase_6+0x11d\u0026gt; 1947:\t48 83 c3 01 add $0x1,%rbx # rbxåˆšåˆšä¸º1,è¿™é‡Œå°±æ˜¯ä½œä¸ºä¸€ä¸ªå¾ªç¯æ§åˆ¶å˜é‡ ++indexï¼ˆç¬¬äºŒå±‚å¾ªç¯ï¼‰ 194b:\t83 fb 05 cmp $0x5,%ebx # å’Œ5æ¯”è¾ƒ 194e:\t0f 8f a7 00 00 00 jg 19fb \u0026lt;phase_6+0x103\u0026gt; # å¦‚æœå¤§äº5è·³è½¬ 1954:\t41 8b 44 9d 00 mov 0x0(%r13,%rbx,4),%eax # r15å°äº5çš„æƒ…å†µï¼šeaxä¸­å­˜æ”¾ *(rsp + 4 * index) 1959:\t39 45 00 cmp %eax,0x0(%rbp) # å’Œé¦–å…ƒç´ åšæ¯”è¾ƒ 195c:\t75 e9 jne 1947 \u0026lt;phase_6+0x4f\u0026gt; # ä¸ç›¸ç­‰è·³è½¬ï¼Œç›¸ç­‰ç›´æ¥çˆ†ç‚¸ 195e:\te8 63 03 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1963:\teb e2 jmp 1947 \u0026lt;phase_6+0x4f\u0026gt; 1965:\t48 8b 54 24 08 mov 0x8(%rsp),%rdx # è‡³æ­¤è¾“å…¥æ£€æŸ¥å·²ç»ç»“æŸ,rdx = rsp + 16ï¼ˆä¸è¦æƒ³é”™äº†ï¼Œè¿™é‡Œå­˜æ”¾çš„å€¼æ˜¯rsp + 16ï¼‰ 196a:\t48 83 c2 18 add $0x18,%rdx # rdx = rsp + 36 196e:\tb9 07 00 00 00 mov $0x7,%ecx # rcx = 7 1973:\t89 c8 mov %ecx,%eax # eax = 7 1975:\t41 2b 04 24 sub (%r12),%eax # eaxä¸º7å‡å»æ•°ç»„ä¸­çš„å…ƒç´  1979:\t41 89 04 24 mov %eax,(%r12) # å†æŠŠè¿™ä¸ªå‡äº†ä¹‹åçš„å€¼åŠ è½½å›å» 197d:\t49 83 c4 04 add $0x4,%r12 # ä¸‹ä¸€ä¸ªæ•°å­— 1981:\t4c 39 e2 cmp %r12,%rdx # æ£€æŸ¥ç»ˆæ­¢æ¡ä»¶ 1984:\t75 ed jne 1973 \u0026lt;phase_6+0x7b\u0026gt; 1986:\tbe 00 00 00 00 mov $0x0,%esi # ç°åœ¨è¾“å…¥çš„æ¯ä¸ªæ•°å­—éƒ½æˆäº†å®ƒå¯¹äº7çš„è¡¥ rsi = 0ï¼Œå‡è®¾è¾“å…¥2 6 1 5 4 3 æ­¤æ—¶çš„å€¼å°±æ˜¯ 5 1 6 2 3 4 rsi = 0 198b:\t8b 4c b4 10 mov 0x10(%rsp,%rsi,4),%ecx # rcx = *(rsp + 16 + 4 * rsi) ä¸ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼ 198f:\tb8 01 00 00 00 mov $0x1,%eax # eax = 1 1994:\t48 8d 15 75 38 00 00 lea 0x3875(%rip),%rdx # gdbæŸ¥çœ‹å†…å­˜è¿™é‡Œå°±æ˜¯æŠŠä¸€ä¸ªé“¾è¡¨çš„node1çš„åœ°å€åŠ è½½ç»™äº†rdx,å°è¯•ç”¨gdbå»æŸ¥çœ‹é“¾è¡¨çš„å…·ä½“ç»“æ„ï¼Œå¤§æ¦‚å°±æ˜¯ç»“æ„ä½“{value + key + nextAddress} 199b:\t83 f9 01 cmp $0x1,%ecx # rcxå¤„çš„å€¼å’Œ1æ¯”è¾ƒ 199e:\t7e 0b jle 19ab \u0026lt;phase_6+0xb3\u0026gt; # å°äºç­‰äº1å°±è·³è½¬ 19a0:\t48 8b 52 08 mov 0x8(%rdx),%rdx # rdxæ­¤æ—¶åº”è¯¥ä¸ºèŠ‚ç‚¹æŒ‡å‘çš„èŠ‚ç‚¹çš„åœ°å€ 19a4:\t83 c0 01 add $0x1,%eax # ++eax 19a7:\t39 c8 cmp %ecx,%eax # rcxå’Œ eaxæ¯”è¾ƒ 19a9:\t75 f5 jne 19a0 \u0026lt;phase_6+0xa8\u0026gt; # ä¸ç›¸ç­‰è·³è½¬ï¼Œç›´åˆ°æ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼å’Œé“¾è¡¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼ç›¸ç­‰å°±è·³è½¬ 19ab:\t48 89 54 f4 30 mov %rdx,0x30(%rsp,%rsi,8) # *(rsp + 48 + 8 * rsi) = rdx æŠŠè¿™ä¸ªåœ°å€å­˜æ”¾åœ¨stackä¸Šé¢ 19b0:\t48 83 c6 01 add $0x1,%rsi # ++rsi 19b4:\t48 83 fe 06 cmp $0x6,%rsi # å¾ªç¯ç»ˆæ­¢æ¡ä»¶ 19b8:\t75 d1 jne 198b \u0026lt;phase_6+0x93\u0026gt; # ä¸ç›¸ç­‰ç»§ç»­ 19ba:\t48 8b 5c 24 30 mov 0x30(%rsp),%rbx # ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠæŒ‰ç…§è¾“å…¥æ•°å­—é¡ºåºèŠ‚ç‚¹æŒ‡å‘çš„åœ°å€æ”¾åœ¨äº†æ ˆä¸Šï¼ˆäººè¯ï¼Ÿï¼‰rbxä¸ºç¬¬ä¸€ä¸ªåœ°å€ 19bf:\t48 8b 44 24 38 mov 0x38(%rsp),%rax # raxæ˜¯ç¬¬äºŒä¸ªåœ°å€ 19c4:\t48 89 43 08 mov %rax,0x8(%rbx) # ä»¥ä¸‹å°±æ˜¯æŠŠé“¾è¡¨æŒ‰ç…§æˆ‘ä»¬è¾“å…¥çš„é¡ºåºè¿æ¥åœ¨ä¸€èµ·ï¼Œçœ‹ä¸æ˜ç™½å°±ç”»å›¾ 19c8:\t48 8b 54 24 40 mov 0x40(%rsp),%rdx 19cd:\t48 89 50 08 mov %rdx,0x8(%rax) 19d1:\t48 8b 44 24 48 mov 0x48(%rsp),%rax 19d6:\t48 89 42 08 mov %rax,0x8(%rdx) 19da:\t48 8b 54 24 50 mov 0x50(%rsp),%rdx 19df:\t48 89 50 08 mov %rdx,0x8(%rax) 19e3:\t48 8b 44 24 58 mov 0x58(%rsp),%rax 19e8:\t48 89 42 08 mov %rax,0x8(%rdx) 19ec:\t48 c7 40 08 00 00 00 movq $0x0,0x8(%rax) # 0å°±æ˜¯nullèŠ‚ç‚¹ 19f3:\t00 19f4:\tbd 05 00 00 00 mov $0x5,%ebp # rbp = 5 19f9:\teb 35 jmp 1a30 \u0026lt;phase_6+0x138\u0026gt; # è¿æ¥å®Œäº†ä¹‹åè·³è½¬ 19fb:\t49 83 c7 01 add $0x1,%r15 # è¿™æ˜¯åº”è¯¥æ˜¯ç¬¬ä¸€å±‚å¾ªç¯ 19ff:\t49 83 c6 04 add $0x4,%r14 # ä¸‹ä¸€ä¸ª 1a03:\t4c 89 f5 mov %r14,%rbp # åœ¨æˆåŠŸè¯»å–å…­ä¸ªæ•°å­—ä¹‹åè·³è½¬åˆ°è¿™é‡Œï¼Œrbpå­˜æ”¾rsp + 16åœ°å€ï¼ˆç¬¬ä¸€æ¬¡ï¼‰ 1a06:\t41 8b 06 mov (%r14),%eax # è¯»å–çš„ç¬¬ä¸€ä¸ªæ•°å­— 1a09:\t83 e8 01 sub $0x1,%eax # è¯»å–çš„æ•°å­—-1 1a0c:\t83 f8 05 cmp $0x5,%eax # å’Œ5ä½œæ¯”è¾ƒ 1a0f:\t0f 87 28 ff ff ff ja 193d \u0026lt;phase_6+0x45\u0026gt; # å¤§äº5çˆ†ç‚¸ï¼ˆè¿™æ„å‘³ç€ä¸èƒ½è¾“å…¥å¤§äº6çš„æ•°å­—ï¼‰ 1a15:\t41 83 ff 05 cmp $0x5,%r15d # r15åˆšåˆšèµ‹å€¼ä¸º1,ç°åœ¨å’Œ5ä½œæ¯”è¾ƒ 1a19:\t0f 8f 46 ff ff ff jg 1965 \u0026lt;phase_6+0x6d\u0026gt; # å¤§äº5è·³è½¬ï¼ˆåˆ°è¿™é‡Œä¸ºæ­¢ï¼Œç»è¿‡äº†ä¸€ä¸ªç±»ä¼¼äºå†’æ³¡æ’åºçš„æ¯”è¾ƒï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬è¾“å…¥çš„æ•°å­—ä¸èƒ½æœ‰é‡å¤çš„ä¹Ÿä¸èƒ½å¤§äº6ï¼‰ 1a1f:\t4c 89 fb mov %r15,%rbx # rbx = 1 1a22:\te9 2d ff ff ff jmp 1954 \u0026lt;phase_6+0x5c\u0026gt; 1a27:\t48 8b 5b 08 mov 0x8(%rbx),%rbx 1a2b:\t83 ed 01 sub $0x1,%ebp 1a2e:\t74 11 je 1a41 \u0026lt;phase_6+0x149\u0026gt;\t1a30:\t48 8b 43 08 mov 0x8(%rbx),%rax # è¿æ¥ä¹‹ååœ¨è¿™é‡Œ 1a34:\t8b 00 mov (%rax),%eax 1a36:\t39 03 cmp %eax,(%rbx) 1a38:\t7d ed jge 1a27 \u0026lt;phase_6+0x12f\u0026gt;\t# ä¹Ÿå°±æ˜¯è¯´é“¾è¡¨å¿…é¡»æ˜¯é€’å¢è¿˜æ˜¯é€’å‡çš„ä¸€ä¸ªé¡ºåºï¼Ÿ 1a3a:\te8 87 02 00 00 call 1cc6 \u0026lt;explode_bomb\u0026gt; 1a3f:\teb e6 jmp 1a27 \u0026lt;phase_6+0x12f\u0026gt; 1a41:\t48 8b 44 24 68 mov 0x68(%rsp),%rax 1a46:\t64 48 2b 04 25 28 00 sub %fs:0x28,%rax 1a4d:\t00 00 1a4f:\t75 0f jne 1a60 \u0026lt;phase_6+0x168\u0026gt; 1a51:\t48 83 c4 78 add $0x78,%rsp 1a55:\t5b pop %rbx 1a56:\t5d pop %rbp 1a57:\t41 5c pop %r12 1a59:\t41 5d pop %r13 1a5b:\t41 5e pop %r14 1a5d:\t41 5f pop %r15 1a5f:\tc3 ret 1a60:\te8 eb f7 ff ff call 1250 \u0026lt;__stack_chk_fail@plt\u0026gt; ä¸å®¹æ˜“ï¼Œç»ˆäºå†™å®Œäº†ã€‚\n","date":"9 March 2025","externalUrl":null,"permalink":"/tech/csappbomblab/","section":"Tech","summary":"","title":"CSAPP:BombLab","type":"tech"},{"content":" \u0026ldquo;My Heart Is In The Work.\u0026rdquo; \u0026mdash;Andrew Carnegie\n","date":"8 March 2025","externalUrl":null,"permalink":"/tech/","section":"Tech","summary":"","title":"Tech","type":"tech"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"}]