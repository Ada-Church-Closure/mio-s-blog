<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="false"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>MySQL &middot; Mio&#39;s Tea Time</title>
  <meta name="title" content="MySQL &middot; Mio&#39;s Tea Time" />
  
  <meta name="description" content="Mio&#39;s Tea Time" />
  
  
  
  <link rel="canonical" href="http://localhost:1313/tech/mysql/" />
  
  
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.1c9cd0d1ebaf117272b5c4f6bd49878475cb210d5e0da4f061632d779f5bb46851881c187e6e634dba5071c4e3d80e7d5cec1dd80443b2fa68acd358f9eda881.css"
    integrity="sha512-HJzQ0euvEXJytcT2vUmHhHXLIQ1eDaTwYWMtd59btGhRiBwYfm5jTbpQccTj2A59XOwd2ARDsvporNNY&#43;e2ogQ==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.65b5de43825ad54a420102c9ddccece1f1015665fe76e5b399ba259e1de29f6c83ac1b3cf77beed3d29e26604dfebf561a8e1db523cb6add0d6acccc9e8f1307.js"
    integrity="sha512-ZbXeQ4Ja1UpCAQLJ3czs4fEBVmX&#43;duWzmbolnh3in2yDrBs893vu09KeJmBN/r9WGo4dtSPLat0NaszMno8TBw==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  <meta name="google-site-verification" content="wgfczhyzH3lSC7Nvoty3A1-Ekb1NZsLDiZjGnjb-LbU" />
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/tech/mysql/">
  <meta property="og:site_name" content="Mio&#39;s Tea Time">
  <meta property="og:title" content="MySQL">
  <meta property="og:description" content="本期封面是笔者早期最喜欢的动漫角色之一，《とある科学の超電磁砲》中的长点上机学园的天才少女布束砥信，至今笔者的github头像都是她……
MySQL # ​	1.2024.7.6,本文仅仅是笔者对于SQL语句的简单熟悉和复习的笔记，所以并不会对于更深刻的细节进行考究，也不会介绍怎么安装和配置MySQL的环境以及为什么我们要使用关系型数据库。Linux肯定是最方便的.
​	2.2025.10.8,为了找实习,我们进行第二次的学习,会深入一些关于SQL的细节问题.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tech">
    <meta property="article:published_time" content="2025-03-12T18:02:43+08:00">
    <meta property="article:modified_time" content="2025-03-12T18:02:43+08:00">
    <meta property="og:image" content="http://localhost:1313/tech/mysql/featured.jpg">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/tech/mysql/featured.jpg">
  <meta name="twitter:title" content="MySQL">
  <meta name="twitter:description" content="本期封面是笔者早期最喜欢的动漫角色之一，《とある科学の超電磁砲》中的长点上机学园的天才少女布束砥信，至今笔者的github头像都是她……
MySQL # ​	1.2024.7.6,本文仅仅是笔者对于SQL语句的简单熟悉和复习的笔记，所以并不会对于更深刻的细节进行考究，也不会介绍怎么安装和配置MySQL的环境以及为什么我们要使用关系型数据库。Linux肯定是最方便的.
​	2.2025.10.8,为了找实习,我们进行第二次的学习,会深入一些关于SQL的细节问题.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Tech",
    "name": "MySQL",
    "headline": "MySQL",
    
    "abstract": "\u003cblockquote\u003e\n\u003cp\u003e本期封面是笔者早期最喜欢的动漫角色之一，《とある科学の超電磁砲》中的长点上机学园的天才少女布束砥信，至今笔者的github头像都是她\u0026hellip;\u0026hellip;\u003c\/p\u003e\u003c\/blockquote\u003e\n\n\n\u003ch1 class=\u0022relative group\u0022\u003eMySQL \n    \u003cdiv id=\u0022mysql\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\u0022\u003e\n        \u003ca class=\u0022group-hover:text-primary-300 dark:group-hover:text-neutral-700\u0022\n            style=\u0022text-decoration-line: none !important;\u0022 href=\u0022#mysql\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e        \n    \n\u003c\/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e​\t1.2024.7.6,本文仅仅是笔者对于SQL语句的\u003cstrong\u003e简单熟悉和复习的笔记\u003c\/strong\u003e，所以并不会对于更深刻的细节进行考究，也不会介绍怎么安装和配置MySQL的环境以及为什么我们要使用关系型数据库。Linux肯定是最方便的.\u003c\/p\u003e\n\u003cp\u003e​\t2.2025.10.8,为了找实习,我们进行第二次的学习,会深入一些关于SQL的细节问题.\u003c\/p\u003e",
    "inLanguage": "en",
    "url" : "http:\/\/localhost:1313\/tech\/mysql\/",
    "author" : {
      "@type": "Person",
      "name": "mio"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-03-12T18:02:43\u002b08:00",
    "datePublished": "2025-03-12T18:02:43\u002b08:00",
    
    "dateModified": "2025-03-12T18:02:43\u002b08:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "1975"
  }]
  </script>


  
  
  <meta name="author" content="mio" />
  
  
  
  <link href="https://nunotabashinobu066@gmail.com" rel="me" />
  
  
  <link href="https://space.bilibili.com/167160408" rel="me" />
  
  
  <link href="https://github.com/Ada-Church-Closure" rel="me" />
  
  
  <link href="https://www.google.com/" rel="me" />
  
  
  <link href="https://steamcommunity.com/id/331979248/" rel="me" />
  
  
  <link href="https://www.youtube.com/@NunotabaShinobu" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
  
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyCswaKAVVuCYg9UesFR0aQOkre1tVIv5co",
      authDomain: "AIzaSyCswaKAVVuCYg9UesFR0aQOkre1tVIv5co",
      projectId: "mio-s-app",
      storageBucket: "mio-s-app.firebasestorage.app",
      messagingSenderId: "491061548873",
      appId: "1:491061548873:web:9de625ab436bdfd1e3ec98",
      measurementId: "G-EH5EXVC7V4"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">Mio&rsquo;s Tea Time</span>

            
            <img src="/img/logo.png" width="342" height="318"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="Mio&#39;s Tea Time" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Mio&rsquo;s Tea Time</a>
            

        </nav>
        <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">

            
            
             
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a  class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="">
      Class
    </a>
    <span>
      

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href="/notes/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Lecture Notes
          </p>
        </a>
        
        <a href="/csapp/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            CS:APP
          </p>
        </a>
        
        <a href="/cs61/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="Cs61s">
            CS61:Series
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>



            
             
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a  class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="">
      Tech
    </a>
    <span>
      

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            MySQL
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>



            
            
  <a href="/thinking/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Thinking">
        Thinking
    </p>
</a>



            
            
  <a href="/life/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Life">
        Life
    </p>
</a>



            
            
  <a href="/author/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Author
    </p>
</a>



            
            
  <a href="https://github.com/Ada-Church-Closure"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <span >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


    </span>
    
    <p class="text-base font-medium" title="">
        
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class=" flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                     
  <li class="mt-1">
    <a href="" class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Class
        </p>
        <span>
            

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


        </span>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Lecture Notes
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/csapp/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            CS:APP
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/cs61/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="Cs61s">
            CS61:Series
        </p>
    </a>
</li>

<li class="mb-2"></li>




                    

                     
  <li class="mt-1">
    <a href="" class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Tech
        </p>
        <span>
            

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


        </span>
    </a>
</li>

<li class="mt-1">
    <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            MySQL
        </p>
    </a>
</li>

<li class="mb-2"></li>




                    

                    
  <li class="mt-1">
    <a href="/thinking/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Thinking">
            Thinking
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/life/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Life">
            Life
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/author/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Author
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="https://github.com/Ada-Church-Closure"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <div >
            

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


        </div>
        
        <p class="text-bg font-bg" title="">
            
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  
        
            <div class="w-full h-36 md:h-56 lg:h-72 single_hero_basic nozoom" style="background-image:url(/tech/mysql/featured_hu_9647334a0a05b9ce.jpg);"></div>
        
    
  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      MySQL
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  



  



  



  







<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2025-03-12T18:02:43&#43;08:00">12 March 2025</time><span class="px-2 text-primary-500">&middot;</span><span>1975 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">10 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_Tech/MySQL/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="likes_Tech/MySQL/index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
    <button id="button_likes"
        class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
        onclick="process_article()">
        <span id="button_likes_heart" style="display:none" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

 </span>
        <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg>
  </span>

</span>
        <span id="button_likes_text">&nbsp;Like</span>
    </button>
</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#语言分类">语言分类</a></li>
      </ul>
    </li>
    <li><a href="#1table">1.Table</a></li>
    <li><a href="#2data">2.Data</a></li>
    <li><a href="#3datatype">3.DataType</a>
      <ul>
        <li><a href="#varchar和char类型">varchar和char类型?</a></li>
        <li><a href="#blobbinary-large-object-and-text">blob(Binary Large Object) and text</a></li>
      </ul>
    </li>
    <li><a href="#4列属性完整性重点">4.列属性完整性(重点)</a>
      <ul>
        <li><a href="#primary-key主键唯一性一组或者一个字段"><strong>primary key主键：唯一性	一组或者一个字段</strong></a></li>
        <li><a href="#foreign-key外键约束技术"><strong>Foreign Key（外键约束技术）</strong></a></li>
      </ul>
    </li>
    <li><a href="#置空和级联的操作在创建表的时候就要声明清楚"><strong>置空和级联的操作（在创建表的时候就要声明清楚）</strong></a></li>
    <li><a href="#5数据库设计思维">5.数据库设计思维</a></li>
    <li><a href="#a基本概念">a.基本概念</a></li>
    <li><a href="#b实体之间的关系">b.实体之间的关系</a></li>
    <li><a href="#c三大范式">c.三大范式</a>
      <ul>
        <li><a href="#建表的时候要考虑什么">建表的时候要考虑什么?</a></li>
      </ul>
    </li>
    <li><a href="#6单表查询">6.*单表查询</a></li>
    <li><a href="#a基本关键字">a.基本关键字</a>
      <ul>
        <li><a href="#select">select</a></li>
        <li><a href="#select查询语句的顺序">select查询语句的顺序?</a></li>
        <li><a href="#sql的隐式转换">sql的隐式转换</a></li>
        <li><a href="#sql的语法树解析">SQL的语法树解析</a></li>
        <li><a href="#from">from</a></li>
        <li><a href="#dual">dual</a></li>
        <li><a href="#where">where</a></li>
        <li><a href="#in">in</a></li>
        <li><a href="#betweenand"><strong>between…and…</strong></a></li>
        <li><a href="#is-null">is null</a></li>
        <li><a href="#几种常见的聚合函数">*几种常见的聚合函数</a></li>
        <li><a href="#like模糊查询通配符">like模糊查询——通配符</a></li>
        <li><a href="#group-by-分组查询">group by 分组查询</a></li>
        <li><a href="#having">having</a></li>
        <li><a href="#order-by">order by</a></li>
        <li><a href="#limit">*limit</a></li>
        <li><a href="#distinct">distinct</a></li>
      </ul>
    </li>
    <li><a href="#7多表查询">7.多表查询</a>
      <ul>
        <li><a href="#1union">1.union</a></li>
        <li><a href="#2join"><strong>2.join</strong></a>
          <ul>
            <li><a href="#内连接">内连接</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#8子查询">8.子查询</a>
      <ul>
        <li><a href="#in和exists的区别">in和exists的区别?</a></li>
        <li><a href="#null值的问题">NULL值的问题</a></li>
      </ul>
    </li>
    <li><a href="#扩展内容">*扩展内容：</a></li>
    <li><a href="#1视图view">1.视图(View)</a></li>
    <li><a href="#2事务transaction">2.*事务（Transaction）</a></li>
    <li><a href="#3index索引">3.index（索引）</a>
      <ul>
        <li><a href="#数据结构">数据结构</a></li>
      </ul>
    </li>
    <li><a href="#4存储过程">4.存储过程</a></li>
    <li><a href="#企业规范约束"><em><strong>企业规范约束</strong></em></a></li>
    <li><a href="#1库表字段的约束规范">1.库表字段的约束规范</a></li>
    <li><a href="#2索引规范">2.索引规范</a></li>
    <li><a href="#3sql开发约束">3.SQL开发约束</a></li>
    <li><a href="#4其他约束">4.其他约束</a></li>
    <li><a href="#mysql基本架构">*Mysql基本架构</a>
      <ul>
        <li><a href="#三层架构">三层架构</a></li>
        <li><a href="#udpate原理">udpate原理</a></li>
        <li><a href="#段区页行">段区页行</a></li>
      </ul>
    </li>
    <li><a href="#常见存储引擎">*常见存储引擎</a>
      <ul>
        <li><a href="#怎么选择存储引擎">怎么选择存储引擎?</a></li>
        <li><a href="#innodb的内存结构">InnoDB的内存结构</a></li>
        <li><a href="#针对于一个数据页的结构">针对于一个数据页的结构</a></li>
        <li><a href="#innodb-对-lru-算法的优化了解吗">InnoDB 对 LRU 算法的优化了解吗？</a></li>
      </ul>
    </li>
    <li><a href="#log文件">*log文件</a>
      <ul>
        <li><a href="#有哪些log文件">有哪些log文件?</a>
          <ul>
            <li><a href="#我们重点理解一下binlog">我们重点理解一下binLog</a></li>
            <li><a href="#有了binlog为什么还要undolog-redolog">有了binlog为什么还要undolog redolog？</a></li>
            <li><a href="#binlog和redolog具体的区别">binlog和redolog具体的区别?</a></li>
            <li><a href="#为什么要进行2pc的两阶段提交">为什么要进行2PC的两阶段提交?</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#语言分类">语言分类</a></li>
      </ul>
    </li>
    <li><a href="#1table">1.Table</a></li>
    <li><a href="#2data">2.Data</a></li>
    <li><a href="#3datatype">3.DataType</a>
      <ul>
        <li><a href="#varchar和char类型">varchar和char类型?</a></li>
        <li><a href="#blobbinary-large-object-and-text">blob(Binary Large Object) and text</a></li>
      </ul>
    </li>
    <li><a href="#4列属性完整性重点">4.列属性完整性(重点)</a>
      <ul>
        <li><a href="#primary-key主键唯一性一组或者一个字段"><strong>primary key主键：唯一性	一组或者一个字段</strong></a></li>
        <li><a href="#foreign-key外键约束技术"><strong>Foreign Key（外键约束技术）</strong></a></li>
      </ul>
    </li>
    <li><a href="#置空和级联的操作在创建表的时候就要声明清楚"><strong>置空和级联的操作（在创建表的时候就要声明清楚）</strong></a></li>
    <li><a href="#5数据库设计思维">5.数据库设计思维</a></li>
    <li><a href="#a基本概念">a.基本概念</a></li>
    <li><a href="#b实体之间的关系">b.实体之间的关系</a></li>
    <li><a href="#c三大范式">c.三大范式</a>
      <ul>
        <li><a href="#建表的时候要考虑什么">建表的时候要考虑什么?</a></li>
      </ul>
    </li>
    <li><a href="#6单表查询">6.*单表查询</a></li>
    <li><a href="#a基本关键字">a.基本关键字</a>
      <ul>
        <li><a href="#select">select</a></li>
        <li><a href="#select查询语句的顺序">select查询语句的顺序?</a></li>
        <li><a href="#sql的隐式转换">sql的隐式转换</a></li>
        <li><a href="#sql的语法树解析">SQL的语法树解析</a></li>
        <li><a href="#from">from</a></li>
        <li><a href="#dual">dual</a></li>
        <li><a href="#where">where</a></li>
        <li><a href="#in">in</a></li>
        <li><a href="#betweenand"><strong>between…and…</strong></a></li>
        <li><a href="#is-null">is null</a></li>
        <li><a href="#几种常见的聚合函数">*几种常见的聚合函数</a></li>
        <li><a href="#like模糊查询通配符">like模糊查询——通配符</a></li>
        <li><a href="#group-by-分组查询">group by 分组查询</a></li>
        <li><a href="#having">having</a></li>
        <li><a href="#order-by">order by</a></li>
        <li><a href="#limit">*limit</a></li>
        <li><a href="#distinct">distinct</a></li>
      </ul>
    </li>
    <li><a href="#7多表查询">7.多表查询</a>
      <ul>
        <li><a href="#1union">1.union</a></li>
        <li><a href="#2join"><strong>2.join</strong></a>
          <ul>
            <li><a href="#内连接">内连接</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#8子查询">8.子查询</a>
      <ul>
        <li><a href="#in和exists的区别">in和exists的区别?</a></li>
        <li><a href="#null值的问题">NULL值的问题</a></li>
      </ul>
    </li>
    <li><a href="#扩展内容">*扩展内容：</a></li>
    <li><a href="#1视图view">1.视图(View)</a></li>
    <li><a href="#2事务transaction">2.*事务（Transaction）</a></li>
    <li><a href="#3index索引">3.index（索引）</a>
      <ul>
        <li><a href="#数据结构">数据结构</a></li>
      </ul>
    </li>
    <li><a href="#4存储过程">4.存储过程</a></li>
    <li><a href="#企业规范约束"><em><strong>企业规范约束</strong></em></a></li>
    <li><a href="#1库表字段的约束规范">1.库表字段的约束规范</a></li>
    <li><a href="#2索引规范">2.索引规范</a></li>
    <li><a href="#3sql开发约束">3.SQL开发约束</a></li>
    <li><a href="#4其他约束">4.其他约束</a></li>
    <li><a href="#mysql基本架构">*Mysql基本架构</a>
      <ul>
        <li><a href="#三层架构">三层架构</a></li>
        <li><a href="#udpate原理">udpate原理</a></li>
        <li><a href="#段区页行">段区页行</a></li>
      </ul>
    </li>
    <li><a href="#常见存储引擎">*常见存储引擎</a>
      <ul>
        <li><a href="#怎么选择存储引擎">怎么选择存储引擎?</a></li>
        <li><a href="#innodb的内存结构">InnoDB的内存结构</a></li>
        <li><a href="#针对于一个数据页的结构">针对于一个数据页的结构</a></li>
        <li><a href="#innodb-对-lru-算法的优化了解吗">InnoDB 对 LRU 算法的优化了解吗？</a></li>
      </ul>
    </li>
    <li><a href="#log文件">*log文件</a>
      <ul>
        <li><a href="#有哪些log文件">有哪些log文件?</a>
          <ul>
            <li><a href="#我们重点理解一下binlog">我们重点理解一下binLog</a></li>
            <li><a href="#有了binlog为什么还要undolog-redolog">有了binlog为什么还要undolog redolog？</a></li>
            <li><a href="#binlog和redolog具体的区别">binlog和redolog具体的区别?</a></li>
            <li><a href="#为什么要进行2pc的两阶段提交">为什么要进行2PC的两阶段提交?</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <blockquote>
<p>本期封面是笔者早期最喜欢的动漫角色之一，《とある科学の超電磁砲》中的长点上机学园的天才少女布束砥信，至今笔者的github头像都是她&hellip;&hellip;</p></blockquote>


<h1 class="relative group">MySQL 
    <div id="mysql" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#mysql" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<blockquote>
<p>​	1.2024.7.6,本文仅仅是笔者对于SQL语句的<strong>简单熟悉和复习的笔记</strong>，所以并不会对于更深刻的细节进行考究，也不会介绍怎么安装和配置MySQL的环境以及为什么我们要使用关系型数据库。Linux肯定是最方便的.</p>
<p>​	2.2025.10.8,为了找实习,我们进行第二次的学习,会深入一些关于SQL的细节问题.</p>
<p>​	3.<strong>练习,练习,练习</strong>,开始时不要过度依赖图形化工具.这会让你失去手写的能力!</p>
<p>​	4.2025.11.14,深入数据库原理,针对面试学习.</p></blockquote>
<p>数据库的连接:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mariadb</span><span class="w"> </span><span class="o">-</span><span class="n">q</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w">
</span></span></span></code></pre></div><p>企业&mdash;&gt;远程连接.</p>
<p>关系型数据库&mdash;&gt;二维表关联.</p>
<p>DBMS&mdash;&gt;内置的数据库管理系统.&mdash;&gt;一个数据库下存放多张table.</p>


<h3 class="relative group">语言分类 
    <div id="%E8%AF%AD%E8%A8%80%E5%88%86%E7%B1%BB" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%AF%AD%E8%A8%80%E5%88%86%E7%B1%BB" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><strong>DDL Define&mdash;&gt;数据库定义语言,数据库,表,字段的创建等.</strong></p>
<p><strong>DML Manipulation&mdash;&gt;数据库操作语言,数据CRUD.</strong></p>
<p><strong>DQL Query&mdash;&gt;查询,查询数据记录.</strong></p>
<p>DCL Control&mdash;&gt;控制访问权限问题,其实就是<strong>数据库</strong>的用户权限的问题.</p>
<p>查看当前正在操作的数据库:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">MariaDB</span><span class="w"> </span><span class="p">[</span><span class="n">db01</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="k">database</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></div><p>这里的<strong>database</strong>都可以替换成<strong>schema</strong>.</p>
<p>可以使用一些图形化操作工具.</p>


<h2 class="relative group">1.Table 
    <div id="1table" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#1table" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>创建表：有B格地创建一张表&mdash;&gt;创建的时候使用约束.</p>
<p><strong>字段约束:</strong></p>
<p>not null&mdash;&gt;非空</p>
<p>unique&mdash;&gt;数据要唯一</p>
<p>primary key&mdash;&gt;主键(<strong>auto_increment</strong> 自动增长)</p>
<p>default&mdash;&gt;未指定的情况下有一个默认值</p>
<p>foreign key&mdash;&gt;外键约束,两张表建立连接</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image.png" alt="image.png" />
      
    </figure>
</p>
<p>查看表结构：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">desc</span><span class="w"> </span><span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">delete</span><span class="p">:</span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>查看所有表:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">show</span><span class="w"> </span><span class="n">tables</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>更高级的,查看当时创建表时候的语句:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">show</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p><strong>修改表字段</strong></p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image1.png" alt="image1.png" />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="w"> </span><span class="k">add</span><span class="p">(</span><span class="err">增加字段</span><span class="p">)</span><span class="o">/</span><span class="n">change</span><span class="p">(</span><span class="err">修改名称</span><span class="p">)</span><span class="o">/</span><span class="k">modify</span><span class="p">(</span><span class="err">修改类型</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">name1</span><span class="o">&gt;</span><span class="err">……</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">&lt;</span><span class="n">name1</span><span class="o">&gt;</span><span class="w"> </span><span class="k">rename</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="o">&lt;</span><span class="n">name2</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">student</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p><strong>绝对不要用这样的方式去清空一张表</strong></p>
<p>1.遍历删除，会浪费时间和资源</p>
<p>2.若设置auto increment 主键，那么再加入数据的时候会从原来增长的部分继续</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">truncate</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">student</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>直接报废表并且创建一张和原来一样的新表</p>


<h2 class="relative group">2.Data 
    <div id="2data" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#2data" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>DML&mdash;&gt;对于数据进行操作.</p>
<p>直接根据字段进行插入:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">teacher</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Touma&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Male&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>你也可以进行<strong>批量</strong>的操作:&mdash;&gt;这是<strong>直接针对字段</strong>进行插入的操作.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">teacher</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">sex</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Haruki&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Male&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Oi&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Female&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>1.插入的值和字段一一对应.</p>
<p>2.字符串和日期包含在引号内部.</p>
<p>3.插入数据满足约束的要求.</p></blockquote>
<p><strong>update</strong> data:</p>
<blockquote>
<p><strong>没有where就会更新整张表的所有行.</strong></p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">update</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="o">&lt;</span><span class="n">field</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="n">newValue</span><span class="o">&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">&lt;</span><span class="n">field</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>search data from table:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">&lt;</span><span class="n">fieldname</span><span class="p">,</span><span class="err">…</span><span class="o">&gt;</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="w">
</span></span></span></code></pre></div><p><strong>delete</strong>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">teacher</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>还是不要delete from 做所谓的遍历删除.</p></blockquote>


<h2 class="relative group">3.DataType 
    <div id="3datatype" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#3datatype" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>数值类型/字符串类型/时间日期类型</p>
<blockquote>
<p>针对字段选取合适的数据类型,直接查询就可以.</p></blockquote>
<p>​	日期 date/date_time&mdash;&gt;<strong>每次创建或者更新都要有create_time,update_time,id作为基础字段</strong>,其余自己增加的都是原型字段.</p>
<p>Decimal数据存储原理？&mdash;&gt;以字符串的形式来进行存储.</p>
<p>​	decimal(5,2)&mdash;&gt;5代表整个数字长度,2代表小数位数的长度.</p>
<p>enum枚举类型：仅能选取其中已经有的 元素来存储，代表从一开始的数字</p>
<p>set集合类型:能从集合中选取多个元素进行存储——用户兴趣标签</p>
<p>set存储原理？？？</p>


<h3 class="relative group">varchar和char类型? 
    <div id="varchar%E5%92%8Cchar%E7%B1%BB%E5%9E%8B" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#varchar%E5%92%8Cchar%E7%B1%BB%E5%9E%8B" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	1.varchar 是可变⻓度的字符类型，原则上最多可以容纳 65535 个字符，但考虑字符集，以及 MySQL 需要 1 到2个字节来表示字符串⻓度，所以实际上最⼤可以设置到 65533。</p>
<p>​	2.char 是固定⻓度的字符类型，当定义⼀个 CHAR(10) 字段时，不管实际存储的字符⻓度是多少，都只会占⽤ 10个字符的空间。如果插⼊的数据⼩于 10 个字符，剩余的部分会⽤空格填充。</p>


<h3 class="relative group">blob(Binary Large Object) and text 
    <div id="blobbinary-large-object-and-text" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#blobbinary-large-object-and-text" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	1.blob⽤于存储⼆进制数据，⽐如图⽚、⾳频、视频、⽂件等；但实际开发中，我们都会把这些⽂件存储到 OSS 或者⽂件服务器上，然后在数据库中存储⽂件的 URL。
​	2.text ⽤于存储⽂本数据，⽐如⽂章、评论、⽇志等。</p>


<h2 class="relative group">4.列属性完整性(重点) 
    <div id="4%E5%88%97%E5%B1%9E%E6%80%A7%E5%AE%8C%E6%95%B4%E6%80%A7%E9%87%8D%E7%82%B9" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#4%E5%88%97%E5%B1%9E%E6%80%A7%E5%AE%8C%E6%95%B4%E6%80%A7%E9%87%8D%E7%82%B9" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">auto_increment</span><span class="w"> </span><span class="err">必须是</span><span class="w"> </span><span class="n">primarykey主键</span><span class="w">
</span></span></span></code></pre></div></blockquote>


<h3 class="relative group"><strong>primary key主键：唯一性	一组或者一个字段</strong> 
    <div id="primary-key%E4%B8%BB%E9%94%AE%E5%94%AF%E4%B8%80%E6%80%A7%E4%B8%80%E7%BB%84%E6%88%96%E8%80%85%E4%B8%80%E4%B8%AA%E5%AD%97%E6%AE%B5" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#primary-key%E4%B8%BB%E9%94%AE%E5%94%AF%E4%B8%80%E6%80%A7%E4%B8%80%E7%BB%84%E6%88%96%E8%80%85%E4%B8%80%E4%B8%AA%E5%AD%97%E6%AE%B5" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>1.保证数据的<strong>完整性</strong>,和一致性.</p>
<p>2.加快数据的查询速度&mdash;&gt;用来做表的关联</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span><span class="n">filedname</span><span class="o">&gt;</span><span class="p">......);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 添加主键，多个字段就是组合键
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="w"> </span><span class="k">drop</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 删除主键
</span></span></span></code></pre></div><p>复合主键解决的问题</p>
<p>unique唯一键</p>
<p>和primary的区别：可以为null，不和其他表产生关联，但是必须唯一（null不唯一）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="w"> </span><span class="k">drop</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">&lt;</span><span class="n">filedname</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>comment 注释问题</p>
<p>SQL内注释和代码注释</p>
<p>数据库的完整性问题</p>


<h3 class="relative group"><strong>Foreign Key（外键约束技术）</strong> 
    <div id="foreign-key%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E6%8A%80%E6%9C%AF" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#foreign-key%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E6%8A%80%E6%9C%AF" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>怎么在<strong>两张表</strong>之间建立联系？</p>
<p>主表：</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image2.png" alt="image2.png" />
      
    </figure>
</p>
<p>建立从表：&mdash;&gt;创建的语法要注意.</p>
<blockquote>
<p>这是物理外键:<strong>禁用</strong>,影响效率,容易引发死锁的问题.</p>
<p>实际开发中我们采用逻辑外键,在业务层面来解决问题.&mdash;&gt;交给代码层面来处理?</p></blockquote>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image3.png" alt="image3.png" />
      
    </figure>
</p>
<p>从表：</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image4.png" alt="image4.png" />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="k">foreign</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span><span class="n">filedname</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="k">references</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="n">filedname</span><span class="o">&gt;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">show</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>查看创建的表结构并且删除外键</p>
<p>当主表中的数据发生变化的时候，从表中的数据应该如何修改？</p>


<h2 class="relative group"><strong>置空和级联的操作（在创建表的时候就要声明清楚）</strong> 
    <div id="%E7%BD%AE%E7%A9%BA%E5%92%8C%E7%BA%A7%E8%81%94%E7%9A%84%E6%93%8D%E4%BD%9C%E5%9C%A8%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%9A%84%E6%97%B6%E5%80%99%E5%B0%B1%E8%A6%81%E5%A3%B0%E6%98%8E%E6%B8%85%E6%A5%9A" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E7%BD%AE%E7%A9%BA%E5%92%8C%E7%BA%A7%E8%81%94%E7%9A%84%E6%93%8D%E4%BD%9C%E5%9C%A8%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%9A%84%E6%97%B6%E5%80%99%E5%B0%B1%E8%A6%81%E5%A3%B0%E6%98%8E%E6%B8%85%E6%A5%9A" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>置空：主表中的数据被删除，那么从表中的数据依然保存，但是外键的被删除的字段为NULL；</p>
<p>级联：主表中的数据发生修改，从表中的外键对应字段的数据全部发生修改；</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image5.png" alt="image5.png" />
      
    </figure>
</p>
<p>如图：删除——set null</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image6.png" alt="image6.png" />
      
    </figure>
</p>


<h2 class="relative group">5.数据库设计思维 
    <div id="5%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E6%80%9D%E7%BB%B4" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#5%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E6%80%9D%E7%BB%B4" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<blockquote>
<p>​	分析业务模块之间的关系.&mdash;&gt;这个设计可能是非常复杂的,我觉得实习生一般不会设计,项目应该会交给DBA?</p></blockquote>


<h2 class="relative group">a.基本概念 
    <div id="a%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#a%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p><strong>关系</strong>：两张表通过<strong>共同的字段</strong>来确立<strong>数据的完整性</strong></p>
<p><strong>行——一条数据——实体</strong></p>
<p><strong>列——一个字段——属性</strong></p>
<p><strong>数据冗余</strong>：牺牲空间，提升查询性能（高考总分）</p>


<h2 class="relative group">b.实体之间的关系 
    <div id="b%E5%AE%9E%E4%BD%93%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#b%E5%AE%9E%E4%BD%93%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>一对多(学生表和食堂消费记录之间的关系)</p>
<p>一对一(比如用户和身份信息&mdash;&gt;表拆分) 比如加入外键,关联主表的主键,然后把把这个外键设置成unique即可.</p>
<p>多对一(大学选课,建立中间表,建立两个外键关联双方的主键,相当于这个第三方表存放了这些选课的信息)</p>
<p>多对多</p>


<h2 class="relative group">c.三大范式 
    <div id="c%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#c%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<blockquote>
<p>原子性,比如地址要拆分成省市县之类的.</p></blockquote>
<p>Codd第一范式：确保字段的<strong>原子性</strong>，<strong>一个字段不可以再分</strong> 2018-2019 —— 2018 2019</p>
<blockquote>
<p>不加入无用的信息,我感觉这两个讲的是一个东西.</p></blockquote>
<p>Codd第二范式：非键字段必须依赖于主键字段（无关的字段不应当加入，一张表只描述一种信息）</p>
<blockquote>
<p>?查询信息的时候不能查询到冗余信息.</p></blockquote>
<p>Codd第三范式：消除<strong>传递依赖</strong>——根据实际情况，我们到底要不要考虑加入数据冗余的处理</p>


<h3 class="relative group">建表的时候要考虑什么? 
    <div id="%E5%BB%BA%E8%A1%A8%E7%9A%84%E6%97%B6%E5%80%99%E8%A6%81%E8%80%83%E8%99%91%E4%BB%80%E4%B9%88" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%BB%BA%E8%A1%A8%E7%9A%84%E6%97%B6%E5%80%99%E8%A6%81%E8%80%83%E8%99%91%E4%BB%80%E4%B9%88" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	⾸先需要考虑表是否符合数据库的<strong>三⼤范式</strong>，确保<strong>字段不可再分</strong>，消除**⾮主键依赖**，确保字段仅依赖于主键等。
​	然后在选择字段类型时，应该尽量选择<strong>合适的数据类型</strong>。
​	在字符集上，尽量选择 <strong>utf8mb4</strong>，这样不仅可以⽀持中⽂和英⽂，还可以⽀持<strong>表情符号</strong>等。
​	当数据量较⼤时，⽐如上千万⾏数据，需要考虑<strong>分表</strong>。⽐如<strong>订单表</strong>，可以<strong>采⽤⽔平分表</strong>的⽅式来分散单表存储压⼒。</p>


<h2 class="relative group">6.*单表查询 
    <div id="6%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#6%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<blockquote>
<p>DQL,查询是SQL的重点问题,因为这也是BS软件操作中最为频繁的.</p></blockquote>


<h2 class="relative group">a.基本关键字 
    <div id="a%E5%9F%BA%E6%9C%AC%E5%85%B3%E9%94%AE%E5%AD%97" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#a%E5%9F%BA%E6%9C%AC%E5%85%B3%E9%94%AE%E5%AD%97" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">select 
    <div id="select" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#select" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>比如说我们查看一张table的结构并且进行查找:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">desc</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">password</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="c1">-- *返回所有的字段(不直观而且性能差(为什么?))
</span></span></span><span class="line"><span class="cl"><span class="c1">-- SQL解析* 要进行元数据的查找操作
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">nickname</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fucking_ps</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="c1">-- 作为别名来返回
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="c1">-- distinct去重
</span></span></span></code></pre></div><p>还有很多其余的用法</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image7.png" alt="image7.png" />
      
    </figure>
</p>


<h3 class="relative group">select查询语句的顺序? 
    <div id="select%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E7%9A%84%E9%A1%BA%E5%BA%8F" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#select%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E7%9A%84%E9%A1%BA%E5%BA%8F" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	先执⾏ FROM 确定主表，再执⾏ JOIN 连接，然后 WHERE 进⾏过滤，接着 GROUP BY 进⾏分组,HAVING过滤聚合结果，<strong>SELECT 选择最终列</strong>，ORDER BY 排序，最后 LIMIT 限制返回⾏数。</p>
<p>​	<strong>WHERE</strong> 先执⾏是为了减少数据量，<strong>HAVING 只能过滤聚合数据</strong>，<strong>ORDER BY 必须在 SELECT 之后排序最终结果,LIMIT 最后执⾏以减少数据传输。</strong></p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image-20251114161215158.png" alt="image-20251114161215158" />
      
    </figure>
</p>
<blockquote>
<p>​	这个执⾏顺序与<strong>编写 SQL 语句</strong>的顺序不同，这也是为什么有时候在 <strong>SELECT</strong> ⼦句中定义的别名不能在 WHERE ⼦句中使⽤的原因，因为 <strong>WHERE</strong> 是在 <strong>SELECT</strong> 之前执⾏的.</p>
<p>​	LIMIT在最后执行:因为 LIMIT 是在最终结果集上执⾏的，如果在 WHERE 之前执⾏ LIMIT，那么就会先返回所有⾏，然后再进⾏LIMIT 限制，这样会增加数据传输的开销.</p></blockquote>


<h3 class="relative group">sql的隐式转换 
    <div id="sql%E7%9A%84%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sql%E7%9A%84%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">MariaDB</span><span class="w"> </span><span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">     </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">001</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">MariaDB</span><span class="w"> </span><span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">       </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">000</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div><p>整数转换成浮点数,字符串转换成整数.</p>


<h3 class="relative group">SQL的语法树解析 
    <div id="sql%E7%9A%84%E8%AF%AD%E6%B3%95%E6%A0%91%E8%A7%A3%E6%9E%90" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sql%E7%9A%84%E8%AF%AD%E6%B3%95%E6%A0%91%E8%A7%A3%E6%9E%90" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	SQL 语法树解析是将 <strong>SQL 查询语句</strong>转换成<strong>抽象语法树</strong> —— <strong>AST</strong> 的过程，是数据库引擎处理查询的第⼀步，也是防⽌ SQL 注⼊的重要⼿段。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">18</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>1.拆解识别关键字:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">[SELECT] [id] [,] [name] [FROM] [users] [WHERE] [age] [&gt;] [18] [;]
</span></span></code></pre></div><p>2.构建抽象语法树.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">SELECT
</span></span><span class="line"><span class="cl">├── COLUMNS: id, name
</span></span><span class="line"><span class="cl">├── FROM: users
</span></span><span class="line"><span class="cl">├── WHERE
</span></span><span class="line"><span class="cl">│	  ├── CONDITION: age &gt; 18
</span></span></code></pre></div><p>3.检查是否存在 + 权限验证</p>


<h3 class="relative group">from 
    <div id="from" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#from" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>指定要查的表；<strong>返回两张表的笛卡尔积</strong></p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image8.png" alt="image8.png" />
      
    </figure>
</p>


<h3 class="relative group">dual 
    <div id="dual" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#dual" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>默认的一个<strong>虚拟表，单行单列</strong></p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image9.png" alt="image9.png" />
      
    </figure>
</p>


<h3 class="relative group">where 
    <div id="where" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#where" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>限制select查询条件 &lt; ≤ &gt; ≥ or and……</p>
<p>举几个例子:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="p">;</span><span class="c1">-- 判断是否有值 要用is null/ is not null
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;123456&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2000-01-01&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="s1">&#39;2000-01-01&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span><span class="c1">-- 限定日期的范围
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;__&#39;</span><span class="p">;</span><span class="c1">-- 模糊匹配 _匹配一个字符 %匹配任意字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;张%&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div>

<h3 class="relative group">in 
    <div id="in" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#in" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>限定查询的字段的值在一个范围之内</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image10.png" alt="image10.png" />
      
    </figure>
</p>


<h3 class="relative group"><strong>between…and…</strong> 
    <div id="betweenand" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#betweenand" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>限制查询的范围在给定的闭区间内部</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image11.png" alt="image11.png" />
      
    </figure>
</p>


<h3 class="relative group">is null 
    <div id="is-null" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#is-null" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>查看是空或者非空，简单</p>


<h3 class="relative group">*几种常见的聚合函数 
    <div id="%E5%87%A0%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%87%A0%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><strong>count max min avg sum</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- count 1.数量统计 2.count(常量) 3.count(*)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">job</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="c1">-- 不重复的工作种类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="mi">114514</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="c1">-- 推荐使用这个*,底层进行了优化的处理.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- min max 选取极值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">min</span><span class="p">(</span><span class="n">tb_emp</span><span class="p">.</span><span class="n">entrydate</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">tb_emp</span><span class="p">.</span><span class="n">entrydate</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">tb_emp</span><span class="p">.</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image12.png" alt="image12.png" />
      
    </figure>
</p>
<blockquote>
<p>[!TIP]</p>
<p>**Q:select  count(*) and select count(1); **</p>
<p><strong>what’s the difference?</strong></p>
<p>​	在 InnoDB 引擎中， COUNT(1) 和 COUNT(*) 没有区别，都是⽤来统计所有⾏，包括 NULL。
如果表有索引， COUNT(*) 会<strong>直接⽤索引统计，⽽不是全表扫描</strong>，⽽ COUNT(1) 也会被 MySQL 优化为COUNT(*) 。COUNT(列名) 只统计列名不为 NULL 的⾏数。</p>
<p>​	<strong>另外，MySQL 8.0 官⽅⼿册有明确说明，InnoDB 引擎对 SELECT COUNT(*) 和 SELECT COUNT(1) 的处理⽅式完全⼀致，性能并⽆差异。</strong></p></blockquote>


<h3 class="relative group">like模糊查询——通配符 
    <div id="like%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E9%80%9A%E9%85%8D%E7%AC%A6" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#like%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E9%80%9A%E9%85%8D%E7%AC%A6" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image13.png" alt="image13.png" />
      
    </figure>
</p>


<h3 class="relative group">group by 分组查询 
    <div id="group-by-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#group-by-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>不抽象,其实就是根据某个字段来进行分组.</p>
<p>将某一列数据作为一个整体来进行纵向的计算.</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">&lt;</span><span class="k">function</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="n">fieldname1</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;alias1&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">fieldname2</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;alias2&#39;</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">&lt;</span><span class="n">fieldname2</span><span class="o">&gt;</span><span class="p">;</span><span class="c1">-- 要根据哪个字段去查询
</span></span></span></code></pre></div><p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image14.png" alt="image14.png" />
      
    </figure>
</p>
<p>比如想求男性和女性的平均年龄：</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image15.png" alt="image15.png" />
      
    </figure>
</p>
<p>利用group_concat函数查询对应字段对应的实体</p>
<p>进行一些比较复杂的查询:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="w"> </span><span class="p">,</span><span class="n">tb_emp</span><span class="p">.</span><span class="n">gender</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;gender&#39;</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">gender</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;job&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;2015-01-01&#39;</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">having</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div>

<h3 class="relative group">having 
    <div id="having" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#having" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>和where一样作为条件筛选，但是：</p>
<p>1.where是根据条件对于实际存在于数据库中的数据进行筛选</p>
<blockquote>
<p>分组之前where先进行一次过滤,分组之后having再进行过滤.</p></blockquote>
<p>2.having<strong>对于查询之后的虚拟表使用</strong>——比如配合group_by(此时就不能使用where条件来处理)</p>
<blockquote>
<p>where不能对聚合函数进行作用.</p></blockquote>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image17.png" alt="image17.png" />
      
    </figure>
</p>


<h3 class="relative group">order by 
    <div id="order-by" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#order-by" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>排序的函数.</p></blockquote>
<p>asc升序,desc降序.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="k">asc</span><span class="p">,</span><span class="w"> </span><span class="n">update_time</span><span class="w"> </span><span class="k">desc</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>前一个字段的值相同的时候才会进行下一个字段的排序.</p>


<h3 class="relative group">*limit 
    <div id="limit" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#limit" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>选取顺序中的下标范围</p>
<blockquote>
<p>比如实现用户界面的分页条,就利用limit来进行查询.&mdash;&gt;分页查询.</p>
<p>有点重点是因为是分页查询的实现原理.</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">&lt;</span><span class="n">fieldname</span><span class="o">&gt;</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="o">&lt;</span><span class="k">start</span><span class="o">-</span><span class="k">index</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="k">length</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image18.png" alt="image18.png" />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="c1">-- 忽略起始索引.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="c1">-- 直接计算起始索引,要进行页码的换算.
</span></span></span></code></pre></div>

<h3 class="relative group">distinct 
    <div id="distinct" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#distinct" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>去重复关键字</p>
<p>默认情况下有all</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="p">(</span><span class="k">all</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="n">fieldname</span><span class="o">&gt;</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image19.png" alt="image19.png" />
      
    </figure>
</p>
<p>至此，单表查询基础结束。</p>
<p>一些组合查询:</p>
<blockquote>
<p><strong>流程控制函数</strong>,基本查询.</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;张%&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">gender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">entrydate</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2000-01-01&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;2015-12-31&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">update_time</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 利用流程函数if来进行展示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">tb_emp</span><span class="p">.</span><span class="n">gender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Male&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Female&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;Number&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">gender</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- case控制
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">&#39;Sensei&#39;</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">&#39;Mamiko&#39;</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">&#39;Bro&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;GOGOGO&#39;</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;Job&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;Number&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">job</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div>

<h2 class="relative group">7.多表查询 
    <div id="7%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#7%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<blockquote>
<p>就是从多张表中进行连接式的查询.</p></blockquote>


<h3 class="relative group">1.union 
    <div id="1union" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#1union" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="err">…</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">select</span><span class="err">…</span><span class="w">
</span></span></span></code></pre></div><p>对应字段个数必须相等</p>


<h3 class="relative group"><strong>2.join</strong> 
    <div id="2join" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#2join" aria-label="Anchor">#</a>
    </span>        
    
</h3>


<h4 class="relative group">内连接 
    <div id="%E5%86%85%E8%BF%9E%E6%8E%A5" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%86%85%E8%BF%9E%E6%8E%A5" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>这都是内连接的方式:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 这是隐式的内连接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">,</span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 这是显式的内连接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>用两个表创建公共字段进行连接——内连接——有多张表就用多个inner进行连接</p>
<p>内连接仅查询共有的数据.</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image20.png" alt="image20.png" />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">f3</span><span class="o">=</span><span class="n">t2</span><span class="p">.</span><span class="n">f4</span><span class="w"> </span><span class="p">(</span><span class="k">having</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">90</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>left join 以<strong>左表为一个基准</strong>（就算左边没有也要写上去 right join 同理）&mdash;&gt;意思就是完全包含左表的数据.</p>
<p>这个意思就是即使左边没有部门,我们也会把这一行给列出来.</p>
<p>你可以直接把这里的左右想象成物理上的左右连接.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;empName&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;depName&#39;</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image21.png" alt="image21.png" />
      
    </figure>
</p>
<p><strong>cross join返回两张表的笛卡尔积</strong>&mdash;&gt;增加条件的目的就是消除无效的笛卡尔积.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">cross</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">t2</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>natural join自动寻找公共字段并且建立inner join的连接</p>
<p>没有公共字段就返回cross join的结果</p>
<p>using</p>
<p>当两张表的字段完全相同的时候，using指定建立连接的公共字段</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image22.png" alt="image22.png" />
      
    </figure>
</p>


<h2 class="relative group">8.子查询 
    <div id="8%E5%AD%90%E6%9F%A5%E8%AF%A2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#8%E5%AD%90%E6%9F%A5%E8%AF%A2" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>用一个select语句返回的数据范围作为限制的基准（用in和not in 来控制）</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image23.png" alt="image23.png" />
      
    </figure>
</p>
<p>只要存在就全部查询 exists and not exists</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image24.png" alt="image24.png" />
      
    </figure>
</p>


<h3 class="relative group">in和exists的区别? 
    <div id="in%E5%92%8Cexists%E7%9A%84%E5%8C%BA%E5%88%AB" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#in%E5%92%8Cexists%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	当使⽤ IN 时，MySQL 会⾸先执⾏⼦查询，然后将⼦查询的结果集⽤于外部查询的条件。这意味着⼦查询的结果集需要全部加载到内存中。
​	⽽ EXISTS 会对外部查询的每⼀⾏，执⾏⼀次⼦查询。<strong>如果⼦查询返回任何⾏，则 EXISTS 条件为真。 EXISTS 关注的是⼦查询是否返回⾏，⽽不是返回的具体值。</strong></p>
<p>​	IN 适⽤于**⼦查询结果集较⼩<strong>的情况。如果⼦查询</strong>返回⼤量数据**， IN 的性能可能会下降，因为它需要将整个结果集加载到内存。
​	⽽ EXISTS 适⽤于**⼦查询结果集可能很⼤的情况**。由于 <strong>EXISTS</strong> 只需要判断**⼦查询是否返回⾏<strong>，⽽不需要加载整个结果集，因此在某些情况下性能更好，特别是</strong>当⼦查询可以使⽤索引**时。</p>


<h3 class="relative group">NULL值的问题 
    <div id="null%E5%80%BC%E7%9A%84%E9%97%AE%E9%A2%98" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#null%E5%80%BC%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	IN : 如果⼦查询的结果集中包含 <strong>NULL</strong> 值，可能会导致意外的结果。例如， WHERE column IN (subquery) ，如果 subquery 返回 NULL ，则 column IN (subquery) 永远不会为真，除⾮ column 本身也为 NULL 。
​	EXISTS : 对 NULL 值的处理更加直接。 EXISTS 只是检查⼦查询是否返回⾏，不关⼼⾏的具体值，因此不受 NULL值的影响。</p>
<p>举几个很好的例子:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 子查询
</span></span></span><span class="line"><span class="cl"><span class="c1">-- 1.标量子查询,查询只会返回一个结果,比如查询一个部门的所有员工(一行一列)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;教研部&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 2.列子查询,返回一列的数据,in判断是不是在这一列数据内部
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">dept_id</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;教研部&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;咨询部&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 3.行子查询,返回的是一行的数据,可以有多列,怎么对齐---&gt;查询的时候采用组合字段处理
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="p">(</span><span class="n">entrydate</span><span class="p">,</span><span class="w"> </span><span class="n">job</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">entrydate</span><span class="p">,</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;韦一笑&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 4.表子查询,把查询的表作为临时表再次进行查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;empName&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s1">&#39;deptName&#39;</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;2006-01-01&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>​	至此，所有基础内容结束，以上的内容都是<strong>对于一名实习生</strong>来说最为重要的内容（每一种语法单独看来都是很好理解的，但是都联合起来的话就显得很困难），以下为扩展,但是大厂应该问的比较多.</p>


<h2 class="relative group">*扩展内容： 
    <div id="%E6%89%A9%E5%B1%95%E5%86%85%E5%AE%B9" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%89%A9%E5%B1%95%E5%86%85%E5%AE%B9" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h2 class="relative group">1.视图(View) 
    <div id="1%E8%A7%86%E5%9B%BEview" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#1%E8%A7%86%E5%9B%BEview" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>作用：简化SQL查询；掩盖敏感数据</p>
<p>创建视图</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image25.png" alt="image25.png" />
      
    </figure>
</p>
<p>以后就可以直接查询</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image26.png" alt="image26.png" />
      
    </figure>
</p>
<p>alter修改视图</p>
<p>drop直接删除视图</p>
<p>视图底层算法（在使用子查询创建视图的时候）</p>
<p><strong>unchecked</strong></p>
<p>1.temp table 临时表算法</p>
<p>2.merge 合并算法</p>
<p><a href="https://juejin.cn/post/6963254221449723912" target="_blank">Q:有什么区别？</a></p>


<h2 class="relative group">2.*事务（Transaction） 
    <div id="2%E4%BA%8B%E5%8A%A1transaction" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#2%E4%BA%8B%E5%8A%A1transaction" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>处理非常严谨的操作，例如转账等</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image27.png" alt="image27.png" />
      
    </figure>
</p>
<p>设置回滚点 并且返回—— rollback to</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image28.png" alt="image28.png" />
      
    </figure>
</p>
<p><a href="https://zh.wikipedia.org/wiki/ACID" target="_blank"><strong>事务的ACID特性</strong></a></p>
<p><strong>Atomicity 原子性：一个事务不可再分，要么全部执行，要么不执行</strong></p>
<p><strong>Consistensy 一致性:事务提交之后,数据库的完整性没有被破坏</strong></p>
<p><strong>Isolation 隔离性：多个事务同时对一个数据库进行操作，不会产生冲突</strong></p>
<p><strong>Duration 持久性:一旦提交,对于数据库的更改是永久的</strong></p>
<p><strong>注意：仅当engine=innodb的时候，才能使用事务</strong></p>


<h2 class="relative group">3.index（索引） 
    <div id="3index%E7%B4%A2%E5%BC%95" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#3index%E7%B4%A2%E5%BC%95" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<blockquote>
<p>索引的目的就是高效地获取数据.</p></blockquote>
<p>快速查询数据——<strong>实习生要理解到什么程度</strong>？</p>
<p>没有建立index之前,我们要对于整张表进行扫描才能查找到对应的数据.</p>
<p>遍历整张表,根据索引排列构建一个二叉搜索树,以后在查找的时候,对于这个树进行查找即可.</p>
<p>这样的建立提升了查询和排序的效率.</p>
<p>​	但是建立了这样的树形结构,会占用存储空间,降低了update insert delete的效率.&mdash;&gt;要维护数据的索引结构,所以是否要建立要根据表本身的用途.</p>


<h3 class="relative group">数据结构 
    <div id="%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>复习一下基本数据结构.</p></blockquote>
<p>这里基本都是<strong>B+树</strong>.&mdash;&gt;多路平衡搜索树,没那么难.</p>
<p>如果仅有两个节点的话,层数会很深,检索会变慢.</p>
<p>简单的语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 创建索引index
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">create</span><span class="w"> </span><span class="k">unique</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">idx_emp_name</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">(</span><span class="n">name</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 查询索引的信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">show</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 创建主键就会自动生成索引---&gt;主键索引,性能是最高的
</span></span></span><span class="line"><span class="cl"><span class="c1">-- 唯一约束---&gt;唯一索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 怎么删除一个index索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">drop</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">idx_emp_name</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div>

<h2 class="relative group">4.存储过程 
    <div id="4%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#4%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>提前写好SQL一次执行，有点像函数</p>
<p>利用delimiter设置结束符号</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image29.png" alt="image29.png" />
      
    </figure>
</p>


<h2 class="relative group"><em><strong>企业规范约束</strong></em> 
    <div id="%E4%BC%81%E4%B8%9A%E8%A7%84%E8%8C%83%E7%BA%A6%E6%9D%9F" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E4%BC%81%E4%B8%9A%E8%A7%84%E8%8C%83%E7%BA%A6%E6%9D%9F" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<hr>


<h2 class="relative group">1.库表字段的约束规范 
    <div id="1%E5%BA%93%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%9A%84%E7%BA%A6%E6%9D%9F%E8%A7%84%E8%8C%83" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#1%E5%BA%93%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%9A%84%E7%BA%A6%E6%9D%9F%E8%A7%84%E8%8C%83" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>是否： is_vip    unsigned tiny int    length1️⃣ （不能浪费存储）</p>
<p>dont’s</p>
<p>不能有大写字母，</p>
<p>不能以数字开头，</p>
<p>下划线之间不能只有数字，</p>
<p>不能出现负数，</p>
<p>不能有关键字</p>
<p>凡是有小数，必须用decimal数据类型</p>
<p>dos</p>
<p>主键：pk_key，</p>
<p>字符串长度较小时，请使用char，</p>
<p>强制存在的字段：</p>
<p>1.id(unsigned bigint 单表的时候必须自增 primary key)</p>
<p>2.create_time(datetime)</p>
<p>3.update_time(datatime),</p>


<h2 class="relative group">2.索引规范 
    <div id="2%E7%B4%A2%E5%BC%95%E8%A7%84%E8%8C%83" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#2%E7%B4%A2%E5%BC%95%E8%A7%84%E8%8C%83" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>有某些必须：唯一索引</p>
<p>不能查两个以上的关联查询</p>
<p>varchar上建立索引：建立索引的长度</p>


<h2 class="relative group">3.SQL开发约束 
    <div id="3sql%E5%BC%80%E5%8F%91%E7%BA%A6%E6%9D%9F" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#3sql%E5%BC%80%E5%8F%91%E7%BA%A6%E6%9D%9F" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>count(xx,xxx,xx) count(*);</p>
<p>判断为空的方法：</p>
<p><del>where name = null ；</del></p>
<p>where name is null；</p>
<p>不要使用外键和级联（尤其是在高并发的项目中，<strong>牵一发而动全身</strong>）</p>
<p>这些问题在Server层解决</p>
<p>不允许使用存储过程（很难调试，其中的SQL写错了怎么办，和脚本不一样，移植性也很差）</p>
<p>utf-8作为标准编码格式</p>


<h2 class="relative group">4.其他约束 
    <div id="4%E5%85%B6%E4%BB%96%E7%BA%A6%E6%9D%9F" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#4%E5%85%B6%E4%BB%96%E7%BA%A6%E6%9D%9F" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>ORM框架查询不能写*</p>
<p>Q:pujo类(最基础的java类)bool类型不能加is?</p>


<h2 class="relative group">*Mysql基本架构 
    <div id="mysql%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#mysql%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">三层架构 
    <div id="%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>①、连接层主要负责客户端连接的管理，包括验证⽤户身份、权限校验、连接管理等。可以通过数据库连接池来提升连接的处理效率。
②、服务层是 <strong>MySQL</strong> 的核⼼，主要负责查询解析、优化、执⾏等操作。在这⼀层，SQL 语句会经过解析、优化器优化，然后转发到存储引擎执⾏，并返回结果。这⼀层包含查询解析器、优化器、执⾏计划⽣成器、⽇志模块等。
③、存储引擎层负责数据的实际存储和提取。<strong>MySQL</strong> ⽀持多种存储引擎，如 <strong>InnoDB</strong>、MyISAM、Memory 等。</p>
<blockquote>
<p>binlog 在服务层，负责记录 SQL 语句的变化。它记录了所有对数据库进⾏更改的操作，⽤于数据恢复、主从复制等。</p>
<p>也就是log日志系统来辅助恢复.</p></blockquote>


<h3 class="relative group">udpate原理 
    <div id="udpate%E5%8E%9F%E7%90%86" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#udpate%E5%8E%9F%E7%90%86" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>⼀条 UPDATE 语句的执⾏过程包括读取数据⻚、加锁解锁、事务提交、⽇志记录等多个步骤。</p></blockquote>
<p>1.记录undo log,用于回滚.</p>
<p>2.存储引擎还会将更新操作写⼊ redo log，状态标记为 prepare，并确保 redo log 持久化到磁盘。这⼀步可以保证即使系统崩溃，数据也能通过 redo log 恢复到⼀致状态。</p>
<p>3.写完 redo log 后，MySQL <strong>会获取⾏锁</strong>，将 a 的值修改为 1，标记为脏⻚，此时数据仍然在内存的 buffer pool中，不会⽴即写⼊磁盘。后台线程会在适当的时候将脏⻚刷盘，以提⾼性能。</p>
<p>4.最后<strong>提交事务</strong>，<strong>redo log</strong> 中的记录被标记为 <strong>committed</strong>，⾏锁释放。</p>


<h3 class="relative group">段区页行 
    <div id="%E6%AE%B5%E5%8C%BA%E9%A1%B5%E8%A1%8C" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%AE%B5%E5%8C%BA%E9%A1%B5%E8%A1%8C" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<blockquote>
<p>MySQL 是以表的形式存储数据的，⽽表空间的结构则由**段、区、⻚、⾏**组成。</p></blockquote>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image-20251114182905791.png" alt="image-20251114182905791" />
      
    </figure>
</p>
<p>​	①、段：<strong>表空间</strong>由多个<strong>段</strong>组成，常⻅的段有<strong>数据段、索引段、回滚段</strong>等。创建索引时会创建两个段，数据段和索引段，**数据段⽤来存储叶⼦节点中的数据；索引段⽤来存储⾮叶⼦节点的数据。**回滚段包含了事务执⾏过程中⽤于数据回滚的旧数据。
​	②、区：段由⼀个或多个区组成，<strong>区是⼀组连续的⻚</strong>，<strong>通常包含 64 个连续的⻚</strong>，也就是 <strong>1M</strong> 的数据。<strong>使⽤区⽽⾮单独的⻚进⾏数据分配可以优化磁盘操作，减少磁盘寻道时间，特别是在⼤量数据进⾏读写时。</strong>
​	③、⻚：⻚是 <strong>InnoDB</strong> 存储数据的基本单元，标准⼤⼩为 16 KB，索引树上的⼀个节点就是⼀个⻚。也就意味着数据库每次读写都是以 16 KB 为单位的，⼀次最少从磁盘中读取 16KB 的数据到内存，⼀次最少写⼊16KB 的数据到磁盘。
​	④、⾏：<strong>InnoDB</strong> 采⽤⾏存储⽅式，意味着数据按照⾏进⾏<strong>组织和管理</strong>，⾏数据可能有多个格式，⽐如说COMPACT、REDUNDANT、DYNAMIC 等。MySQL 8.0 默认的⾏格式是 <strong>DYNAMIC</strong>，由COMPACT 演变⽽来，<strong>意味着这些数据如果超过了⻚内联存储的限制,则会被存储在溢出⻚中</strong>。</p>
<blockquote>
<p>理论上来说,你的数据是不能超过一整个<strong>page</strong>的大小,否则一定会造成<strong>行溢出</strong>的现象.</p></blockquote>


<h2 class="relative group">*常见存储引擎 
    <div id="%E5%B8%B8%E8%A7%81%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%B8%B8%E8%A7%81%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image-20251114182714111.png" alt="image-20251114182714111" />
      
    </figure>
</p>
<blockquote>
<p>记住 MyISAM 不支持 <strong>外键 + 事务</strong>.</p>
<p>nnoDB 和 MyISAM 的最⼤区别在于事务⽀持和锁机制。InnoDB ⽀持事务、⾏级锁，适合⼤多数业务系统；⽽MyISAM 不⽀持事务，⽤的是表锁，查询快但写⼊性能差，适合读多写少的场景。</p></blockquote>
<p>在你创建表之前就应当指定这个引擎:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">MariaDB</span><span class="w"> </span><span class="p">[</span><span class="n">db01</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">man</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">)</span><span class="n">engine</span><span class="o">=</span><span class="n">myisam</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Query</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="n">affected</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">032</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div>

<h3 class="relative group">怎么选择存储引擎? 
    <div id="%E6%80%8E%E4%B9%88%E9%80%89%E6%8B%A9%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%80%8E%E4%B9%88%E9%80%89%E6%8B%A9%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>⼤多数情况下，使⽤默认的 <strong>InnoDB</strong> 就可以了，InnoDB 可以提供事务、⾏级锁、外键、B+ 树索引等能⼒。
<strong>MyISAM</strong> 适合读多写少的场景。
<strong>MEMORY</strong> 适合临时表，数据量不⼤的情况。因为数据都存放在内存，所以速度⾮常快。</p>


<h3 class="relative group">InnoDB的内存结构 
    <div id="innodb%E7%9A%84%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#innodb%E7%9A%84%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><strong>InnoDB</strong> 的内存区域主要有两块，<strong>buffer pool</strong> 和 <strong>log buffer</strong>。</p>
<p><strong>buffer pool</strong> ⽤于缓存<strong>数据⻚和索引⻚</strong>，提升读写性能；&mdash;&gt;就是B+树</p>
<blockquote>
<p>了解buffer pool么?</p>
<p>​	<strong>Buffer Pool</strong> 是 <strong>InnoDB</strong> 存储引擎中的⼀个内存缓冲区，它会将经常使⽤的**数据⻚、索引⻚**加载进内存，读的时候先查询 Buffer Pool，如果命中就不⽤访问磁盘了。</p>
<p>其实也就是我们实现的page cache,没什么特殊的.</p></blockquote>
<p>log buffer ⽤于缓存 redo log，提升写⼊性能。&mdash;&gt;就是日志的缓存.</p>


<h3 class="relative group">针对于一个数据页的结构 
    <div id="%E9%92%88%E5%AF%B9%E4%BA%8E%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E9%A1%B5%E7%9A%84%E7%BB%93%E6%9E%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E9%92%88%E5%AF%B9%E4%BA%8E%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E9%A1%B5%E7%9A%84%E7%BB%93%E6%9E%84" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="../../../static/img/image-20251115163832186.png" alt="image-20251115163832186" />
      
    </figure>
</p>
<p>数据页的File Header都有指向<strong>上一个page或者下一个page的编号</strong>,构成一个<strong>双向的链表</strong>.</p>


<h3 class="relative group">InnoDB 对 LRU 算法的优化了解吗？ 
    <div id="innodb-%E5%AF%B9-lru-%E7%AE%97%E6%B3%95%E7%9A%84%E4%BC%98%E5%8C%96%E4%BA%86%E8%A7%A3%E5%90%97" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#innodb-%E5%AF%B9-lru-%E7%AE%97%E6%B3%95%E7%9A%84%E4%BC%98%E5%8C%96%E4%BA%86%E8%A7%A3%E5%90%97" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	了解，<strong>InnoDB</strong> 对 <strong>LRU</strong> 算法进⾏了改良，最近访问的数据<strong>并不直接放到 LRU 链表的头部</strong>，⽽是放在⼀个叫midpoiont 的位置。默认情况下，midpoint 位于 LRU 列表的 5/8 处。</p>
<blockquote>
<p>放到头部有可能导致cache抖动?</p>
<p>比如一次扫描了整个page,热点数据反而会被刷掉.</p>
<p>但是放在中间,就表明我要进行一些&quot;观察&quot;,真的是,就会被自然放到最前方.</p></blockquote>


<h2 class="relative group">*log文件 
    <div id="log%E6%96%87%E4%BB%B6" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#log%E6%96%87%E4%BB%B6" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">有哪些log文件? 
    <div id="%E6%9C%89%E5%93%AA%E4%BA%9Blog%E6%96%87%E4%BB%B6" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%9C%89%E5%93%AA%E4%BA%9Blog%E6%96%87%E4%BB%B6" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>​	有 <strong>6 ⼤类</strong>，其中<strong>错误⽇志</strong>⽤于<strong>问题诊断</strong>，<strong>慢查询</strong>⽇志⽤于 <strong>SQL 性能分析</strong>，<strong>general log</strong> ⽤于<strong>记录所有的 SQL 语句</strong>，<strong>binlog</strong> ⽤于<strong>主从复制和数据恢复</strong>，<strong>redo log</strong> ⽤于<strong>保证事务持久性</strong>，<strong>undo log</strong> ⽤于<strong>事务回滚和 MVCC</strong>。</p>
<p>①、错误⽇志（Error Log）：记录 MySQL 服务器<strong>启动、运⾏或停⽌时出现的问题</strong>。
②、慢查询⽇志（Slow Query Log）：记录执⾏时间超过 <strong>long_query_time</strong> 值的所有 SQL 语句。这个时间值是可配置的，默认情况下，慢查询⽇志功能是关闭的。
③、<strong>⼀般查询⽇志</strong>（General Query Log）：记录 <strong>MySQL</strong> 服务器的<strong>启动关闭信息</strong>，客户端的连接信息，以及更新、查询的 <strong>SQL</strong> 语句等。
④、⼆进制⽇志（Binary Log）：记录所有修改数据库状态的 SQL 语句，以及每个语句的执⾏时间，如 INSERT、UPDATE、DELETE 等，但<strong>不包括 SELECT 和 SHOW 这类的操作</strong>。
⑤、重做⽇志（Redo Log）：<strong>记录对于 InnoDB 表的每个写操作</strong>，<strong>不是 SQL 级别的，⽽是物理级别的</strong>，主要⽤于<strong>崩溃恢复</strong>。
⑥、回滚⽇志（Undo Log，或者叫事务⽇志）：<strong>记录数据被修改前的值，⽤于事务的回滚以及MVCC的处理,因为多线程访问的时候,RC会返回旧版本.</strong></p>


<h4 class="relative group">我们重点理解一下binLog 
    <div id="%E6%88%91%E4%BB%AC%E9%87%8D%E7%82%B9%E7%90%86%E8%A7%A3%E4%B8%80%E4%B8%8Bbinlog" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%88%91%E4%BB%AC%E9%87%8D%E7%82%B9%E7%90%86%E8%A7%A3%E4%B8%80%E4%B8%8Bbinlog" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p><strong>binlog</strong> 是⼀种<strong>物理⽇志</strong>，会在磁盘上记录数据库的<strong>所有修改操作</strong>。
如果<strong>误删了数据</strong>，就可以使⽤ <strong>binlog</strong> 进⾏<strong>回退到误删之前的状态</strong>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">步骤</span><span class="mi">1</span><span class="err">：恢复全量备份</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mysql</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">full_backup</span><span class="p">.</span><span class="k">sql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">步骤</span><span class="mi">2</span><span class="err">：应⽤</span><span class="n">Binlog到指定时间点</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mysqlbinlog</span><span class="w"> </span><span class="c1">--start-datetime=&#34;2025-03-13 14:00:00&#34; --stop-datetime=&#34;2025-03-13 15:00:00&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">binlog</span><span class="p">.</span><span class="mi">000001</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">mysql</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w">
</span></span></span></code></pre></div><p>如果要搭建<strong>主从复制</strong>，就可以让<strong>从库定时读取主库的 binlog</strong>。</p>
<p>​	<strong>MySQL</strong> 提供了三种格式的 binlog：<strong>Statement</strong>、<strong>Row</strong> 和 <strong>Mixed</strong>，分别对应 SQL <strong>语句级别</strong>、<strong>⾏级别</strong>和<strong>混合级别</strong>，默认为⾏级别。</p>
<p>从后缀名上来看，<strong>binlog</strong> ⽂件分为两类：以 .index 结尾的索引⽂件，以 .00000* 结尾的⼆进制⽇志⽂件。</p>
<p><strong>一些配置参数:</strong></p>
<p><strong>max_binlog_size=104857600</strong> ⽤于设置每个 binlog ⽂件的⼤⼩，不建议设置太⼤，⽹络传送起来⽐较麻烦。当 binlog ⽂件达到 max_binlog_size 时，MySQL 会关闭当前⽂件并创建⼀个新的 binlog ⽂件。<strong>expire_logs_days = 7</strong> ⽤于设置 binlog ⽂件的⾃动过期时间为 7 天。过期的 binlog ⽂件会被⾃动删除。防⽌⻓时间累积的 binlog ⽂件占⽤过多存储空间，技术派实战项⽬所在的项⽬是丐版服务器，所以这个配置很重要。
<strong>binlog-do-db=db_name</strong>,指定哪些数据库表的更新应该被记录。
<strong>binlog-ignore-db=db_name</strong> ,指定忽略哪些数据库表的更新(比如有一些我们不在乎或者实现一致性是没有必要的)。
<strong>sync_binlog=0</strong> ,设置每多少次 binlog 写操作会触发⼀次磁盘同步操作。默认值为 0，表示 MySQL 不会主动触发同步操作，⽽是依赖操作系统的磁盘缓存策略。即当执⾏写操作时，数据会先写⼊缓存，当缓存区满了再由操作系统将数据⼀次性刷⼊磁盘(只用我们OS自己的策略)。<strong>如果设置为 1</strong>，表示每次 <strong>binlog</strong> 写操作后都会同步到磁盘，虽然可以保证数据能够及时写⼊磁盘，但会降低性能。</p>
<blockquote>
<p>注意,这里是把binlog cache刷入binlog磁盘文件内部.</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">MariaDB</span><span class="w"> </span><span class="p">[</span><span class="n">db01</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%log_bin%&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------------------------------+-------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">Variable_name</span><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------------------------------+-------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">log_bin</span><span class="w">                         </span><span class="o">|</span><span class="w"> </span><span class="k">OFF</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">log_bin_basename</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">log_bin_compress</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">OFF</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">log_bin_compress_min_len</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">256</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">log_bin_index</span><span class="w">                   </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">log_bin_trust_function_creators</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">OFF</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">sql_log_bin</span><span class="w">                     </span><span class="o">|</span><span class="w"> </span><span class="k">ON</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------------------------------+-------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">7</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">002</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div>

<h4 class="relative group">有了binlog为什么还要undolog redolog？ 
    <div id="%E6%9C%89%E4%BA%86binlog%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%98%E8%A6%81undolog-redolog" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%9C%89%E4%BA%86binlog%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%98%E8%A6%81undolog-redolog" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>binlog 属于 Server 层，与存储引擎⽆关，⽆法直接操作物理数据⻚。<strong>⽽ redo log 和 undo log 是 InnoDB 存储引擎实现 ACID 的基⽯。</strong></p>
<p><strong>1.binlog</strong> 关注的是<strong>逻辑变更的全局记录</strong>.比如记录一条sql语句的变化.</p>
<p><strong>2.redo log</strong> ⽤于确保<strong>物理变更的持久性</strong>，确保事务最终能够刷盘成功.</p>
<p><strong>3.undo log</strong> 是<strong>逻辑逆向操作⽇志</strong>，记录的是<strong>旧值</strong>，⽅便<strong>恢复到事务开始前的状态</strong>.</p>
<p><strong>另外⼀种回答⽅式。</strong></p>
<p><strong>binlog</strong> 会<strong>记录整个 SQL 或⾏变化.</strong></p>
<p><strong>redo log 是为了恢复“已提交但未刷盘”的数据，undo log 是为了撤销未提交的事务.</strong></p>
<p>我们理解一下:</p>
<table>
  <thead>
      <tr>
          <th><strong>日志名称</strong></th>
          <th><strong>作用层级</strong></th>
          <th><strong>核心关注点</strong></th>
          <th><strong>核心目的</strong></th>
          <th><strong>与其他日志的关系</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Binlog (Binary Log)</strong></td>
          <td><strong>Server 层</strong></td>
          <td>逻辑变更（SQL 或行数据）</td>
          <td><strong>主从复制</strong>、<strong>数据恢复（时间点）</strong>。它是一个<strong>全局</strong>、<strong>顺序</strong>的日志。</td>
          <td><strong>先于 Redo Log 准备并提交</strong>（遵循<strong>两阶段提交</strong>）。</td>
      </tr>
      <tr>
          <td><strong>Redo Log</strong></td>
          <td><strong>InnoDB 存储引擎层</strong></td>
          <td>物理变更（数据页上的<strong>修改</strong>）</td>
          <td><strong>保证事务的持久性（Durability）</strong>，即使宕机也能恢复已提交的事务。</td>
          <td>保证 Redo Log 写入成功是 <strong>Binlog 最终提交</strong>的前提。</td>
      </tr>
      <tr>
          <td><strong>Undo Log</strong></td>
          <td><strong>InnoDB 存储引擎层</strong></td>
          <td>逻辑逆向操作（记录<strong>旧值</strong>）</td>
          <td><strong>保证事务的原子性（Atomicity）和一致性（Consistency）</strong>（用于回滚）以及 <strong>MVCC</strong> 的实现。</td>
          <td>Redo Log 也会记录 Undo Log 的<strong>修改</strong>。</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>您的理解：“其实 redo log 还是给 binlog 服务的”，这个逻辑关系是颠倒的。</p></blockquote>
<p>Redo Log 和 Binlog 的关系是体现在 <strong>MySQL 的“两阶段提交”</strong> 机制中：</p>
<ol>
<li><strong>准备阶段 (Prepare)：</strong> 事务的修改写入 Redo Log，并标记为 <strong>Prepare</strong> 状态。</li>
<li><strong>提交阶段 (Commit)：</strong> 事务的修改写入 Binlog。</li>
<li><strong>最终提交 (Commit)：</strong> Redo Log 标记为 <strong>Commit</strong> 状态。</li>
</ol>
<p>如果只写了 Binlog 而没有完成 Redo Log 的 Commit，那么系统会认为这个事务<strong>没有成功</strong>。</p>
<p><strong>正确的理解是：</strong></p>
<ul>
<li><strong>Redo Log</strong> 保证了事务执行的 <strong>持久性</strong> (即使宕机，已提交的事务也不丢)。</li>
<li><strong>Undo Log</strong> 保证了事务执行的 <strong>原子性</strong> (可以回滚) 和 <strong>一致性</strong> (MVCC)。</li>
<li><strong>Binlog</strong> 保证了数据库的 <strong>可恢复性</strong> (时间点恢复) 和 <strong>高可用性</strong> (主从复制)。</li>
</ul>
<p>我们来举个例子,以⼀次事务更新为例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">开启事务</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">更新数据</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">提交事务</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">COMMIT</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>1.事务开始的时候会⽣成 undo log，记录更新前的数据，⽐如原值是 18：</p>
<blockquote>
<p>事务开始之前,undolog先记录下来之前的value.</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">undo</span><span class="w"> </span><span class="n">log</span><span class="p">:</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="o">=</span><span class="mi">18</span><span class="w">
</span></span></span></code></pre></div><p>2.<strong>修改数据</strong>的时候，会将数据写⼊到 <strong>redo log</strong>。
⽐如数据⻚ page_id=123 上，id=1 的⽤户被更新为 age=26：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">redo</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="p">(</span><span class="k">prepare</span><span class="p">):</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">page_id</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="k">offset</span><span class="o">=</span><span class="mi">0</span><span class="n">x40</span><span class="p">,</span><span class="w"> </span><span class="k">before</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span><span class="w"> </span><span class="k">after</span><span class="o">=</span><span class="mi">26</span><span class="w">
</span></span></span></code></pre></div><p>3.等事务提交的时候，redo log 刷盘，binlog 刷盘。
binlog 写完之后，redo log 的状态会变为 commit：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">redo</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="p">(</span><span class="k">commit</span><span class="p">):</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">page_id</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="k">offset</span><span class="o">=</span><span class="mi">0</span><span class="n">x40</span><span class="p">,</span><span class="w"> </span><span class="k">before</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span><span class="w"> </span><span class="k">after</span><span class="o">=</span><span class="mi">26</span><span class="w">
</span></span></span></code></pre></div><p>binlog 如果是 <strong>Statement</strong> 格式，会记录⼀条 SQL 语句：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div>

<h4 class="relative group">binlog和redolog具体的区别? 
    <div id="binlog%E5%92%8Credolog%E5%85%B7%E4%BD%93%E7%9A%84%E5%8C%BA%E5%88%AB" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#binlog%E5%92%8Credolog%E5%85%B7%E4%BD%93%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>​	binlog 记录的是逻辑⽇志，包括原始的 SQL 语句或者⾏数据变化，例如“将 id=2 这⾏数据的 age 字段+1”。redo log 记录物理⽇志，即数据⻚的具体修改，例如“将 page_id=123 上 offset=0x40 的数据从 18 修改为 26”。
​	binlog 是追加写⼊的，⽂件写满后会新建⽂件继续写⼊，不会覆盖历史⽇志，保存的是<strong>全量操作记录</strong>；<strong>redo log是循环写⼊的，空间是固定的，写满后会覆盖旧的⽇志</strong>，仅保存<strong>未刷盘的脏⻚⽇志</strong>，<strong>已持久化的数据会被清除</strong>。
​	另外，为保证两种⽇志的⼀致性，<strong>innodb</strong> 采⽤了<strong>两阶段提交策略</strong>，<strong>redo log</strong> 在事务执⾏过程中持续写⼊，并在事务提交前进⼊ <strong>prepare</strong> 状态；binlog 在事务提交的最后阶段写⼊，之后 redo log 会被标记为 commit 状态。可以通过回放 binlog 实现数据同步或者恢复到指定时间点；redo log ⽤来确保事务提交后即使系统宕机，数据仍然可以通过重放 redo log 恢复。</p>


<h4 class="relative group">为什么要进行2PC的两阶段提交? 
    <div id="%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%BF%9B%E8%A1%8C2pc%E7%9A%84%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%BF%9B%E8%A1%8C2pc%E7%9A%84%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>为了保证 redo log 和 binlog 中的数据⼀致性，防⽌主从复制和事务状态不⼀致。</p>
<p>为什么 2PC 能保证 redo log 和 binlog 的强⼀致性？</p>
<p>假如 MySQL 在预写 redo log 之后、写⼊ binlog 之前崩溃。那么 MySQL 重启后 InnoDB 会回滚该事务，因为redo log 不是提交状态。并且由于 binlog 中没有写⼊数据，所以从库也不会有该事务的数据。</p>
<p>假如 MySQL 在写⼊ binlog 之后、redo log 提交之前崩溃。那么 MySQL 重启后 InnoDB 会提交该事务，因为redo log 是完整的 prepare 状态。并且由于 binlog 中有写⼊数据，所以从库也会同步到该事务的数据。</p>
<blockquote>
<p>End.</p></blockquote>

          
          
          
        </div>
        
        

          
            
            
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="mio" src="/img/blowfish_logo_hu_2d15729eafedea4d.png" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      mio
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">I&rsquo;m Just A Student&hellip;</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://nunotabashinobu066@gmail.com"
          target="_blank"
          aria-label="Email"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://space.bilibili.com/167160408"
          target="_blank"
          aria-label="Link"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/Ada-Church-Closure"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.google.com/"
          target="_blank"
          aria-label="Google"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentColor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://steamcommunity.com/id/331979248/"
          target="_blank"
          aria-label="Steam"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111.2 248-248.4 248-113.8 0-209.6-76.3-239-180.4l95.2 39.3c6.4 32.1 34.9 56.4 68.9 56.4 39.2 0 71.9-32.4 70.2-73.5l84.5-60.2c52.1 1.3 95.8-40.9 95.8-93.5 0-51.6-42-93.5-93.7-93.5s-93.7 42-93.7 93.5v1.2L176.6 279c-15.5-.9-30.7 3.4-43.5 12.1L0 236.1C10.2 108.4 117.1 8 247.6 8 384.8 8 496 119 496 256zM155.7 384.3l-30.5-12.6a52.79 52.79 0 0 0 27.2 25.8c26.9 11.2 57.8-1.6 69-28.4 5.4-13 5.5-27.3.1-40.3-5.4-13-15.5-23.2-28.5-28.6-12.9-5.4-26.7-5.2-38.9-.6l31.5 13c19.8 8.2 29.2 30.9 20.9 50.7-8.3 19.9-31 29.2-50.8 21zm173.8-129.9c-34.4 0-62.4-28-62.4-62.3s28-62.3 62.4-62.3 62.4 28 62.4 62.3-27.9 62.3-62.4 62.3zm.1-15.6c25.9 0 46.9-21 46.9-46.8 0-25.9-21-46.8-46.9-46.8s-46.9 21-46.9 46.8c.1 25.8 21.1 46.8 46.9 46.8z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.youtube.com/@NunotabaShinobu"
          target="_blank"
          aria-label="Youtube"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>

  </span>

</span></a
        >
      
    
  </div>

</div>
  </div>
</div>

          

          

          
          <div class="mb-10"></div>
          

        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_Tech\/MySQL\/index.md"
        var oid_likes = "likes_Tech\/MySQL\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
      
      
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/tech/env_setup_log/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Env_setup_log</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-07-28T12:23:03&#43;08:00">28 July 2025</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/reading/"
            title="">
            
            Reading
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2025
      mio
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
